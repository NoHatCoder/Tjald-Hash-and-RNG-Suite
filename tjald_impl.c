//#define TJALD_NO_ASM
//#define TJALD_NO_AES
//#define TJALD_NO_C

#include "tjald_header.h"

#define TJALD_AES_ATTRIBUTE

#if defined(__BYTE_ORDER__) && (__BYTE_ORDER__ == __ORDER_BIG_ENDIAN__)
	#define TJALD_BIG_ENDIAN
#elif defined(_MSC_VER) && !defined(__clang__)
	#define TJALD_MSVC
	#if defined(_M_AMD64) || defined(_M_IX86)
		#include <intrin.h>
		#define TJALD_X86
		#if defined(_M_AMD64)
			#define TJALD_X86_64
		#endif
	#elif defined(_M_ARM64)
		#include <arm64_neon.h>
		#define TJALD_ARM
		#define TJALD_ARM_64
	#elif defined(_M_ARM)
		#include <arm_neon.h>
		#define TJALD_ARM
	#endif
#else
	#if defined(__x86_64__) || defined(__i386__)
		#include <x86intrin.h>
		#if defined(__clang__)
			#include <wmmintrin.h>
			#include <cpuid.h>
		#endif
		#define TJALD_X86
		#if defined(__x86_64__)
			#define TJALD_X86_64
		#endif
		#undef TJALD_AES_ATTRIBUTE
		#define TJALD_AES_ATTRIBUTE __attribute__((__target__("aes")))
	#elif defined(__aarch64__) || defined(__arm__)
		#include <arm_neon.h>
		#define TJALD_ARM
		#if defined(__aarch64__)
			#define TJALD_ARM_64
		#else
			#define TJALD_NO_AES
		#endif
		#undef TJALD_AES_ATTRIBUTE
		#define TJALD_AES_ATTRIBUTE __attribute__((__target__("+aes")))
	#endif
#endif

#if defined(TJALD_ARM) && defined(__linux__)
	#include <sys/auxv.h>
	#include <asm/hwcap.h>
	#define TJALD_ARM_LINUX
#endif

#if defined(TJALD_ARM)
	#define tjald_128 uint8x16_t
	#define tjald_xor(D,A,B) D=veorq_u8(A,B)
	#define tjald_and(D,A,B) D=vandq_u8(A,B)
	#define tjald_add(D,A,B) D=vaddq_u8(A,B)
	#define tjald_sub(D,A,B) D=vsubq_u8(A,B)
	#define tjald_aesenc(D,A,B,C) D=veorq_u8(vaesmcq_u8(vaeseq_u8(A,B)),C)
	#define tjald_load(D,A) D=vld1q_u8((uint8_t*)(A))
	#define tjald_store(A,B) vst1q_u8((uint8_t*)(A),B)
	#define tjald_zero(D) D=vdupq_n_u8(0)
#elif defined(TJALD_X86)
	#define tjald_128 __m128i
	#define tjald_xor(D,A,B) D=_mm_xor_si128(A,B)
	#define tjald_and(D,A,B) D=_mm_and_si128(A,B)
	#define tjald_add(D,A,B) D=_mm_add_epi8(A,B)
	#define tjald_sub(D,A,B) D=_mm_sub_epi8(A,B)
	#define tjald_aesenc(D,A,B,C) D=_mm_aesenc_si128(_mm_xor_si128(A,B),C)
	#define tjald_load(D,A) D=_mm_loadu_si128((__m128i *)(A))
	#define tjald_store(A,B) _mm_storeu_si128((__m128i *)(A),B)
	#define tjald_zero(D) D=_mm_setzero_si128()
#endif

extern uint8_t tjald_small_seed[64];
extern uint8_t tjald_seed[704];

TJALD_ALIGN uint8_t tjald_small_seed[64]={
	0x32,0x43,0xF6,0xA8,0x88,0x5A,0x30,0x8D,0x31,0x31,0x98,0xA2,0xE0,0x37,0x07,0x34,
	0x32,0x43,0xF6,0xA8,0x88,0x5A,0x30,0x8D,0x31,0x31,0x98,0xA2,0xE0,0x37,0x07,0x34,
	0x32,0x43,0xF6,0xA8,0x88,0x5A,0x30,0x8D,0x31,0x31,0x98,0xA2,0xE0,0x37,0x07,0x34,
	0x32,0x43,0xF6,0xA8,0x88,0x5A,0x30,0x8D,0x31,0x31,0x98,0xA2,0xE0,0x37,0x07,0x34
};

TJALD_ALIGN uint8_t tjald_seed[704]={
	0x32,0x43,0xF6,0xA8,0x88,0x5A,0x30,0x8D,0x31,0x31,0x98,0xA2,0xE0,0x37,0x07,0x34,
	0x4A,0x40,0x93,0x82,0x22,0x99,0xF3,0x1D,0x00,0x82,0xEF,0xA9,0x8E,0xC4,0xE6,0xC8,
	0x94,0x52,0x82,0x1E,0x63,0x8D,0x01,0x37,0x7B,0xE5,0x46,0x6C,0xF3,0x4E,0x90,0xC6,
	0xCC,0x0A,0xC2,0x9B,0x7C,0x97,0xC5,0x0D,0xD3,0xF8,0x4D,0x5B,0x5B,0x54,0x70,0x91,
	0x79,0x21,0x6D,0x5D,0x98,0x97,0x9F,0xB1,0xBD,0x13,0x10,0xBA,0x69,0x8D,0xFB,0x5A,
	0xC2,0xFF,0xD7,0x2D,0xBD,0x01,0xAD,0xFB,0x7B,0x8E,0x1A,0xFE,0xD6,0xA2,0x67,0xE9,
	0x6B,0xA7,0xC9,0x04,0x5F,0x12,0xC7,0xF9,0x92,0x4A,0x19,0x94,0x7B,0x39,0x16,0xCF,
	0x70,0x80,0x1F,0x2E,0x28,0x58,0xEF,0xC1,0x66,0x36,0x92,0x0D,0x87,0x15,0x74,0xE6,
	0x9A,0x45,0x8F,0xEA,0x3F,0x49,0x33,0xD7,0xE0,0xD9,0x57,0x48,0xF7,0x28,0xEB,0x65,
	0x87,0x18,0xBC,0xD5,0x88,0x21,0x54,0xAE,0xE7,0xB5,0x4A,0x41,0xDC,0x25,0xA5,0x9B,
	0x59,0xC3,0x0D,0x53,0x92,0xAF,0x26,0x01,0x3C,0x5D,0x1B,0x02,0x32,0x86,0x08,0x5F,
	0x0C,0xA4,0x17,0x91,0x8B,0x8D,0xB3,0x8E,0xF8,0xE7,0x9D,0xCB,0x06,0x03,0xA1,0x80,
	0xE6,0xC9,0xE0,0xE8,0xBB,0x01,0xE8,0xA3,0xED,0x71,0x57,0x7C,0x1B,0xD3,0x14,0xB2,
	0x77,0x8A,0xF2,0xFD,0xA5,0x56,0x05,0xC6,0x0E,0x65,0x52,0x5F,0x3A,0xA5,0x5A,0xB9,
	0x45,0x74,0x89,0x86,0x26,0x3E,0x81,0x44,0x05,0x5C,0xA3,0x96,0xA2,0xAA,0xB1,0x0B,
	0x6B,0x4C,0xC5,0xC3,0x41,0x14,0x1E,0x8C,0xEA,0x15,0x48,0x6A,0xF7,0xC7,0x2E,0x99,
	0x3B,0x3E,0xE1,0x41,0x16,0x36,0xFB,0xC2,0xA2,0xBA,0x9C,0x55,0xD7,0x41,0x83,0x1F,
	0x6C,0xE5,0xC3,0xE1,0x69,0xB8,0x79,0x31,0xEA,0xFD,0x6B,0xA3,0x36,0xC2,0x4C,0xF5,
	0xC7,0xA3,0x25,0x38,0x12,0x89,0x58,0x67,0x73,0xB8,0xF4,0x89,0x86,0xB4,0xBB,0x9A,
	0xFC,0x4B,0xFE,0x81,0xB6,0x62,0x82,0x19,0x36,0x1D,0x80,0x9C,0xCF,0xB2,0x1A,0x99,
	0x14,0x87,0xCA,0xC6,0x05,0xDE,0xC8,0x03,0x2E,0xF8,0x45,0xD5,0xDE,0x98,0x57,0x5B,
	0x1D,0xC2,0x62,0x30,0x2E,0xB6,0x51,0xB8,0x82,0x38,0x93,0xE8,0x1D,0x39,0x6A,0xCC,
	0x50,0xF6,0xD6,0xFF,0x38,0x3F,0x44,0x23,0x92,0xE0,0xB4,0x48,0x2A,0x48,0x42,0x00,
	0x46,0x9C,0x8F,0x04,0xA9,0xE1,0xF9,0xB5,0xE2,0x1C,0x66,0x84,0x2F,0x6E,0x96,0xC9,
	0xA6,0x70,0xC9,0xC6,0x1A,0xBD,0x38,0x8F,0x06,0xA5,0x1A,0x0D,0x2D,0x85,0x42,0xF6,
	0x89,0x60,0xFA,0x72,0x8A,0xB5,0x13,0x3A,0x36,0xEE,0xF0,0xB6,0xC1,0x37,0xA3,0xBE,
	0x4B,0xA3,0xBF,0x05,0x07,0xEF,0xB2,0xA9,0x8A,0x1F,0x16,0x51,0xD3,0x9A,0xF0,0x17,
	0x66,0x6C,0xA5,0x93,0xE8,0x24,0x30,0xE8,0x88,0xCE,0xE8,0x61,0x94,0x56,0xF9,0xFB,
	0x47,0xD8,0x4A,0x5C,0x33,0xB8,0xB5,0xEB,0xEE,0x06,0xF7,0x5D,0x88,0x5C,0x12,0x07,
	0x34,0x01,0xA4,0x49,0xF5,0x6C,0x16,0xAA,0x64,0xED,0x3A,0xA6,0x23,0x63,0xF7,0x70,
	0x61,0xBF,0xED,0xF7,0x24,0x29,0xB0,0x23,0xD3,0x7D,0x0D,0x72,0x4D,0x00,0xA1,0x24,
	0x8D,0xB0,0xFE,0xAD,0x34,0x9F,0x1C,0x09,0xB0,0x75,0x37,0x2C,0x98,0x09,0x91,0xB7,
	0xB2,0x5D,0x47,0x9D,0x8F,0x6E,0x8D,0xEF,0x7E,0x3F,0xE5,0x01,0xAB,0x67,0x94,0xC3,
	0xB9,0x76,0xCE,0x0B,0xD0,0x4C,0x00,0x6B,0xAC,0x1A,0x94,0xFB,0x64,0x09,0xF6,0x0C,
	0x45,0xE5,0xC9,0xEC,0x21,0x96,0xA2,0x46,0x36,0x8F,0xB6,0xFA,0xF3,0xE6,0xC5,0x3B,
	0x51,0x33,0x9B,0x2E,0xB3,0xB5,0x2E,0xC6,0xF6,0xDF,0xC5,0x11,0xF9,0xB3,0x09,0x52,
	0xCC,0xC8,0x14,0x54,0x4A,0xF5,0xEB,0xD0,0x9B,0xEE,0x3D,0x00,0x4D,0xE3,0x34,0xAF,
	0xD6,0x60,0xF2,0x80,0x71,0x92,0xE4,0xBB,0x3C,0x0C,0xBA,0x85,0x74,0x5C,0x87,0x40,
	0xFD,0x20,0xB5,0xF3,0x9B,0x9D,0x3F,0xBD,0xB5,0x57,0x9C,0x0B,0xD1,0xA6,0x03,0x20,
	0xAD,0x6A,0x10,0x0C,0x64,0x02,0xC7,0x27,0x96,0x79,0xF2,0x5F,0xEF,0xB1,0xFA,0x3C,
	0xC8,0xEA,0x5E,0x9F,0x8D,0xB3,0x22,0x2F,0x83,0xC7,0x51,0x6D,0xFF,0xD6,0x16,0xB1,
	0x52,0xF5,0x01,0xEC,0x8A,0xD0,0x55,0x2A,0xB3,0x23,0xDB,0x5F,0xAF,0xD2,0x38,0x76,
	0x05,0x33,0x17,0xB4,0x83,0xE0,0x0D,0xF8,0x29,0xE5,0xC5,0x7B,0xBC,0xA6,0xF8,0xCA,
	0x01,0xA8,0x75,0x62,0xED,0xF1,0x76,0x9D,0xBD,0x54,0x2A,0x8F,0x62,0x87,0xEF,0xFC
};

struct tjald_fn_pointers_ tjald_fn_pointers;

#if !(defined(TJALD_NO_ASM) || !defined(TJALD_X86_64))
	extern int64_t tjald_once_asm_limit(int64_t limit);
	#define TJALD_ASM_AVAILABLE
#endif

#if !defined(TJALD_NO_C)
	#define TJALD_C_AVAILABLE
	#include <string.h>
	
	#if defined(TJALD_BIG_ENDIAN)
	
		uint64_t tjald_inverse_endianess_64(uint64_t in){
			in=(in<<32)|(in>>32);
			in=((in<<16)&0xffff0000ffff0000ULL)|((in>>16)&0x0000ffff0000ffffULL);
			in=((in<<8)&0xff00ff00ff00ff00ULL)|((in>>8)&0x00ff00ff00ff00ffULL);
			return in;
		}
	
		uint32_t tjald_inverse_endianess_32(uint32_t in){
			in=(in<<16)|(in>>16);
			in=((in<<8)&0xff00ff00U)|((in>>8)&0x00ff00ffU);
			return in;
		}
	
		uint32_t tjald_table_0[256]={
			0xc66363a5U,0xf87c7c84U,0xee777799U,0xf67b7b8dU,0xfff2f20dU,0xd66b6bbdU,0xde6f6fb1U,0x91c5c554U,
			0x60303050U,0x02010103U,0xce6767a9U,0x562b2b7dU,0xe7fefe19U,0xb5d7d762U,0x4dababe6U,0xec76769aU,
			0x8fcaca45U,0x1f82829dU,0x89c9c940U,0xfa7d7d87U,0xeffafa15U,0xb25959ebU,0x8e4747c9U,0xfbf0f00bU,
			0x41adadecU,0xb3d4d467U,0x5fa2a2fdU,0x45afafeaU,0x239c9cbfU,0x53a4a4f7U,0xe4727296U,0x9bc0c05bU,
			0x75b7b7c2U,0xe1fdfd1cU,0x3d9393aeU,0x4c26266aU,0x6c36365aU,0x7e3f3f41U,0xf5f7f702U,0x83cccc4fU,
			0x6834345cU,0x51a5a5f4U,0xd1e5e534U,0xf9f1f108U,0xe2717193U,0xabd8d873U,0x62313153U,0x2a15153fU,
			0x0804040cU,0x95c7c752U,0x46232365U,0x9dc3c35eU,0x30181828U,0x379696a1U,0x0a05050fU,0x2f9a9ab5U,
			0x0e070709U,0x24121236U,0x1b80809bU,0xdfe2e23dU,0xcdebeb26U,0x4e272769U,0x7fb2b2cdU,0xea75759fU,
			0x1209091bU,0x1d83839eU,0x582c2c74U,0x341a1a2eU,0x361b1b2dU,0xdc6e6eb2U,0xb45a5aeeU,0x5ba0a0fbU,
			0xa45252f6U,0x763b3b4dU,0xb7d6d661U,0x7db3b3ceU,0x5229297bU,0xdde3e33eU,0x5e2f2f71U,0x13848497U,
			0xa65353f5U,0xb9d1d168U,0x00000000U,0xc1eded2cU,0x40202060U,0xe3fcfc1fU,0x79b1b1c8U,0xb65b5bedU,
			0xd46a6abeU,0x8dcbcb46U,0x67bebed9U,0x7239394bU,0x944a4adeU,0x984c4cd4U,0xb05858e8U,0x85cfcf4aU,
			0xbbd0d06bU,0xc5efef2aU,0x4faaaae5U,0xedfbfb16U,0x864343c5U,0x9a4d4dd7U,0x66333355U,0x11858594U,
			0x8a4545cfU,0xe9f9f910U,0x04020206U,0xfe7f7f81U,0xa05050f0U,0x783c3c44U,0x259f9fbaU,0x4ba8a8e3U,
			0xa25151f3U,0x5da3a3feU,0x804040c0U,0x058f8f8aU,0x3f9292adU,0x219d9dbcU,0x70383848U,0xf1f5f504U,
			0x63bcbcdfU,0x77b6b6c1U,0xafdada75U,0x42212163U,0x20101030U,0xe5ffff1aU,0xfdf3f30eU,0xbfd2d26dU,
			0x81cdcd4cU,0x180c0c14U,0x26131335U,0xc3ecec2fU,0xbe5f5fe1U,0x359797a2U,0x884444ccU,0x2e171739U,
			0x93c4c457U,0x55a7a7f2U,0xfc7e7e82U,0x7a3d3d47U,0xc86464acU,0xba5d5de7U,0x3219192bU,0xe6737395U,
			0xc06060a0U,0x19818198U,0x9e4f4fd1U,0xa3dcdc7fU,0x44222266U,0x542a2a7eU,0x3b9090abU,0x0b888883U,
			0x8c4646caU,0xc7eeee29U,0x6bb8b8d3U,0x2814143cU,0xa7dede79U,0xbc5e5ee2U,0x160b0b1dU,0xaddbdb76U,
			0xdbe0e03bU,0x64323256U,0x743a3a4eU,0x140a0a1eU,0x924949dbU,0x0c06060aU,0x4824246cU,0xb85c5ce4U,
			0x9fc2c25dU,0xbdd3d36eU,0x43acacefU,0xc46262a6U,0x399191a8U,0x319595a4U,0xd3e4e437U,0xf279798bU,
			0xd5e7e732U,0x8bc8c843U,0x6e373759U,0xda6d6db7U,0x018d8d8cU,0xb1d5d564U,0x9c4e4ed2U,0x49a9a9e0U,
			0xd86c6cb4U,0xac5656faU,0xf3f4f407U,0xcfeaea25U,0xca6565afU,0xf47a7a8eU,0x47aeaee9U,0x10080818U,
			0x6fbabad5U,0xf0787888U,0x4a25256fU,0x5c2e2e72U,0x381c1c24U,0x57a6a6f1U,0x73b4b4c7U,0x97c6c651U,
			0xcbe8e823U,0xa1dddd7cU,0xe874749cU,0x3e1f1f21U,0x964b4bddU,0x61bdbddcU,0x0d8b8b86U,0x0f8a8a85U,
			0xe0707090U,0x7c3e3e42U,0x71b5b5c4U,0xcc6666aaU,0x904848d8U,0x06030305U,0xf7f6f601U,0x1c0e0e12U,
			0xc26161a3U,0x6a35355fU,0xae5757f9U,0x69b9b9d0U,0x17868691U,0x99c1c158U,0x3a1d1d27U,0x279e9eb9U,
			0xd9e1e138U,0xebf8f813U,0x2b9898b3U,0x22111133U,0xd26969bbU,0xa9d9d970U,0x078e8e89U,0x339494a7U,
			0x2d9b9bb6U,0x3c1e1e22U,0x15878792U,0xc9e9e920U,0x87cece49U,0xaa5555ffU,0x50282878U,0xa5dfdf7aU,
			0x038c8c8fU,0x59a1a1f8U,0x09898980U,0x1a0d0d17U,0x65bfbfdaU,0xd7e6e631U,0x844242c6U,0xd06868b8U,
			0x824141c3U,0x299999b0U,0x5a2d2d77U,0x1e0f0f11U,0x7bb0b0cbU,0xa85454fcU,0x6dbbbbd6U,0x2c16163aU
		};
		uint32_t tjald_table_1[256]={
			0xa5c66363U,0x84f87c7cU,0x99ee7777U,0x8df67b7bU,0x0dfff2f2U,0xbdd66b6bU,0xb1de6f6fU,0x5491c5c5U,
			0x50603030U,0x03020101U,0xa9ce6767U,0x7d562b2bU,0x19e7fefeU,0x62b5d7d7U,0xe64dababU,0x9aec7676U,
			0x458fcacaU,0x9d1f8282U,0x4089c9c9U,0x87fa7d7dU,0x15effafaU,0xebb25959U,0xc98e4747U,0x0bfbf0f0U,
			0xec41adadU,0x67b3d4d4U,0xfd5fa2a2U,0xea45afafU,0xbf239c9cU,0xf753a4a4U,0x96e47272U,0x5b9bc0c0U,
			0xc275b7b7U,0x1ce1fdfdU,0xae3d9393U,0x6a4c2626U,0x5a6c3636U,0x417e3f3fU,0x02f5f7f7U,0x4f83ccccU,
			0x5c683434U,0xf451a5a5U,0x34d1e5e5U,0x08f9f1f1U,0x93e27171U,0x73abd8d8U,0x53623131U,0x3f2a1515U,
			0x0c080404U,0x5295c7c7U,0x65462323U,0x5e9dc3c3U,0x28301818U,0xa1379696U,0x0f0a0505U,0xb52f9a9aU,
			0x090e0707U,0x36241212U,0x9b1b8080U,0x3ddfe2e2U,0x26cdebebU,0x694e2727U,0xcd7fb2b2U,0x9fea7575U,
			0x1b120909U,0x9e1d8383U,0x74582c2cU,0x2e341a1aU,0x2d361b1bU,0xb2dc6e6eU,0xeeb45a5aU,0xfb5ba0a0U,
			0xf6a45252U,0x4d763b3bU,0x61b7d6d6U,0xce7db3b3U,0x7b522929U,0x3edde3e3U,0x715e2f2fU,0x97138484U,
			0xf5a65353U,0x68b9d1d1U,0x00000000U,0x2cc1ededU,0x60402020U,0x1fe3fcfcU,0xc879b1b1U,0xedb65b5bU,
			0xbed46a6aU,0x468dcbcbU,0xd967bebeU,0x4b723939U,0xde944a4aU,0xd4984c4cU,0xe8b05858U,0x4a85cfcfU,
			0x6bbbd0d0U,0x2ac5efefU,0xe54faaaaU,0x16edfbfbU,0xc5864343U,0xd79a4d4dU,0x55663333U,0x94118585U,
			0xcf8a4545U,0x10e9f9f9U,0x06040202U,0x81fe7f7fU,0xf0a05050U,0x44783c3cU,0xba259f9fU,0xe34ba8a8U,
			0xf3a25151U,0xfe5da3a3U,0xc0804040U,0x8a058f8fU,0xad3f9292U,0xbc219d9dU,0x48703838U,0x04f1f5f5U,
			0xdf63bcbcU,0xc177b6b6U,0x75afdadaU,0x63422121U,0x30201010U,0x1ae5ffffU,0x0efdf3f3U,0x6dbfd2d2U,
			0x4c81cdcdU,0x14180c0cU,0x35261313U,0x2fc3ececU,0xe1be5f5fU,0xa2359797U,0xcc884444U,0x392e1717U,
			0x5793c4c4U,0xf255a7a7U,0x82fc7e7eU,0x477a3d3dU,0xacc86464U,0xe7ba5d5dU,0x2b321919U,0x95e67373U,
			0xa0c06060U,0x98198181U,0xd19e4f4fU,0x7fa3dcdcU,0x66442222U,0x7e542a2aU,0xab3b9090U,0x830b8888U,
			0xca8c4646U,0x29c7eeeeU,0xd36bb8b8U,0x3c281414U,0x79a7dedeU,0xe2bc5e5eU,0x1d160b0bU,0x76addbdbU,
			0x3bdbe0e0U,0x56643232U,0x4e743a3aU,0x1e140a0aU,0xdb924949U,0x0a0c0606U,0x6c482424U,0xe4b85c5cU,
			0x5d9fc2c2U,0x6ebdd3d3U,0xef43acacU,0xa6c46262U,0xa8399191U,0xa4319595U,0x37d3e4e4U,0x8bf27979U,
			0x32d5e7e7U,0x438bc8c8U,0x596e3737U,0xb7da6d6dU,0x8c018d8dU,0x64b1d5d5U,0xd29c4e4eU,0xe049a9a9U,
			0xb4d86c6cU,0xfaac5656U,0x07f3f4f4U,0x25cfeaeaU,0xafca6565U,0x8ef47a7aU,0xe947aeaeU,0x18100808U,
			0xd56fbabaU,0x88f07878U,0x6f4a2525U,0x725c2e2eU,0x24381c1cU,0xf157a6a6U,0xc773b4b4U,0x5197c6c6U,
			0x23cbe8e8U,0x7ca1ddddU,0x9ce87474U,0x213e1f1fU,0xdd964b4bU,0xdc61bdbdU,0x860d8b8bU,0x850f8a8aU,
			0x90e07070U,0x427c3e3eU,0xc471b5b5U,0xaacc6666U,0xd8904848U,0x05060303U,0x01f7f6f6U,0x121c0e0eU,
			0xa3c26161U,0x5f6a3535U,0xf9ae5757U,0xd069b9b9U,0x91178686U,0x5899c1c1U,0x273a1d1dU,0xb9279e9eU,
			0x38d9e1e1U,0x13ebf8f8U,0xb32b9898U,0x33221111U,0xbbd26969U,0x70a9d9d9U,0x89078e8eU,0xa7339494U,
			0xb62d9b9bU,0x223c1e1eU,0x92158787U,0x20c9e9e9U,0x4987ceceU,0xffaa5555U,0x78502828U,0x7aa5dfdfU,
			0x8f038c8cU,0xf859a1a1U,0x80098989U,0x171a0d0dU,0xda65bfbfU,0x31d7e6e6U,0xc6844242U,0xb8d06868U,
			0xc3824141U,0xb0299999U,0x775a2d2dU,0x111e0f0fU,0xcb7bb0b0U,0xfca85454U,0xd66dbbbbU,0x3a2c1616U
		};
		uint32_t tjald_table_2[256]={
			0x63a5c663U,0x7c84f87cU,0x7799ee77U,0x7b8df67bU,0xf20dfff2U,0x6bbdd66bU,0x6fb1de6fU,0xc55491c5U,
			0x30506030U,0x01030201U,0x67a9ce67U,0x2b7d562bU,0xfe19e7feU,0xd762b5d7U,0xabe64dabU,0x769aec76U,
			0xca458fcaU,0x829d1f82U,0xc94089c9U,0x7d87fa7dU,0xfa15effaU,0x59ebb259U,0x47c98e47U,0xf00bfbf0U,
			0xadec41adU,0xd467b3d4U,0xa2fd5fa2U,0xafea45afU,0x9cbf239cU,0xa4f753a4U,0x7296e472U,0xc05b9bc0U,
			0xb7c275b7U,0xfd1ce1fdU,0x93ae3d93U,0x266a4c26U,0x365a6c36U,0x3f417e3fU,0xf702f5f7U,0xcc4f83ccU,
			0x345c6834U,0xa5f451a5U,0xe534d1e5U,0xf108f9f1U,0x7193e271U,0xd873abd8U,0x31536231U,0x153f2a15U,
			0x040c0804U,0xc75295c7U,0x23654623U,0xc35e9dc3U,0x18283018U,0x96a13796U,0x050f0a05U,0x9ab52f9aU,
			0x07090e07U,0x12362412U,0x809b1b80U,0xe23ddfe2U,0xeb26cdebU,0x27694e27U,0xb2cd7fb2U,0x759fea75U,
			0x091b1209U,0x839e1d83U,0x2c74582cU,0x1a2e341aU,0x1b2d361bU,0x6eb2dc6eU,0x5aeeb45aU,0xa0fb5ba0U,
			0x52f6a452U,0x3b4d763bU,0xd661b7d6U,0xb3ce7db3U,0x297b5229U,0xe33edde3U,0x2f715e2fU,0x84971384U,
			0x53f5a653U,0xd168b9d1U,0x00000000U,0xed2cc1edU,0x20604020U,0xfc1fe3fcU,0xb1c879b1U,0x5bedb65bU,
			0x6abed46aU,0xcb468dcbU,0xbed967beU,0x394b7239U,0x4ade944aU,0x4cd4984cU,0x58e8b058U,0xcf4a85cfU,
			0xd06bbbd0U,0xef2ac5efU,0xaae54faaU,0xfb16edfbU,0x43c58643U,0x4dd79a4dU,0x33556633U,0x85941185U,
			0x45cf8a45U,0xf910e9f9U,0x02060402U,0x7f81fe7fU,0x50f0a050U,0x3c44783cU,0x9fba259fU,0xa8e34ba8U,
			0x51f3a251U,0xa3fe5da3U,0x40c08040U,0x8f8a058fU,0x92ad3f92U,0x9dbc219dU,0x38487038U,0xf504f1f5U,
			0xbcdf63bcU,0xb6c177b6U,0xda75afdaU,0x21634221U,0x10302010U,0xff1ae5ffU,0xf30efdf3U,0xd26dbfd2U,
			0xcd4c81cdU,0x0c14180cU,0x13352613U,0xec2fc3ecU,0x5fe1be5fU,0x97a23597U,0x44cc8844U,0x17392e17U,
			0xc45793c4U,0xa7f255a7U,0x7e82fc7eU,0x3d477a3dU,0x64acc864U,0x5de7ba5dU,0x192b3219U,0x7395e673U,
			0x60a0c060U,0x81981981U,0x4fd19e4fU,0xdc7fa3dcU,0x22664422U,0x2a7e542aU,0x90ab3b90U,0x88830b88U,
			0x46ca8c46U,0xee29c7eeU,0xb8d36bb8U,0x143c2814U,0xde79a7deU,0x5ee2bc5eU,0x0b1d160bU,0xdb76addbU,
			0xe03bdbe0U,0x32566432U,0x3a4e743aU,0x0a1e140aU,0x49db9249U,0x060a0c06U,0x246c4824U,0x5ce4b85cU,
			0xc25d9fc2U,0xd36ebdd3U,0xacef43acU,0x62a6c462U,0x91a83991U,0x95a43195U,0xe437d3e4U,0x798bf279U,
			0xe732d5e7U,0xc8438bc8U,0x37596e37U,0x6db7da6dU,0x8d8c018dU,0xd564b1d5U,0x4ed29c4eU,0xa9e049a9U,
			0x6cb4d86cU,0x56faac56U,0xf407f3f4U,0xea25cfeaU,0x65afca65U,0x7a8ef47aU,0xaee947aeU,0x08181008U,
			0xbad56fbaU,0x7888f078U,0x256f4a25U,0x2e725c2eU,0x1c24381cU,0xa6f157a6U,0xb4c773b4U,0xc65197c6U,
			0xe823cbe8U,0xdd7ca1ddU,0x749ce874U,0x1f213e1fU,0x4bdd964bU,0xbddc61bdU,0x8b860d8bU,0x8a850f8aU,
			0x7090e070U,0x3e427c3eU,0xb5c471b5U,0x66aacc66U,0x48d89048U,0x03050603U,0xf601f7f6U,0x0e121c0eU,
			0x61a3c261U,0x355f6a35U,0x57f9ae57U,0xb9d069b9U,0x86911786U,0xc15899c1U,0x1d273a1dU,0x9eb9279eU,
			0xe138d9e1U,0xf813ebf8U,0x98b32b98U,0x11332211U,0x69bbd269U,0xd970a9d9U,0x8e89078eU,0x94a73394U,
			0x9bb62d9bU,0x1e223c1eU,0x87921587U,0xe920c9e9U,0xce4987ceU,0x55ffaa55U,0x28785028U,0xdf7aa5dfU,
			0x8c8f038cU,0xa1f859a1U,0x89800989U,0x0d171a0dU,0xbfda65bfU,0xe631d7e6U,0x42c68442U,0x68b8d068U,
			0x41c38241U,0x99b02999U,0x2d775a2dU,0x0f111e0fU,0xb0cb7bb0U,0x54fca854U,0xbbd66dbbU,0x163a2c16U
		};
		uint32_t tjald_table_3[256]={
			0x6363a5c6U,0x7c7c84f8U,0x777799eeU,0x7b7b8df6U,0xf2f20dffU,0x6b6bbdd6U,0x6f6fb1deU,0xc5c55491U,
			0x30305060U,0x01010302U,0x6767a9ceU,0x2b2b7d56U,0xfefe19e7U,0xd7d762b5U,0xababe64dU,0x76769aecU,
			0xcaca458fU,0x82829d1fU,0xc9c94089U,0x7d7d87faU,0xfafa15efU,0x5959ebb2U,0x4747c98eU,0xf0f00bfbU,
			0xadadec41U,0xd4d467b3U,0xa2a2fd5fU,0xafafea45U,0x9c9cbf23U,0xa4a4f753U,0x727296e4U,0xc0c05b9bU,
			0xb7b7c275U,0xfdfd1ce1U,0x9393ae3dU,0x26266a4cU,0x36365a6cU,0x3f3f417eU,0xf7f702f5U,0xcccc4f83U,
			0x34345c68U,0xa5a5f451U,0xe5e534d1U,0xf1f108f9U,0x717193e2U,0xd8d873abU,0x31315362U,0x15153f2aU,
			0x04040c08U,0xc7c75295U,0x23236546U,0xc3c35e9dU,0x18182830U,0x9696a137U,0x05050f0aU,0x9a9ab52fU,
			0x0707090eU,0x12123624U,0x80809b1bU,0xe2e23ddfU,0xebeb26cdU,0x2727694eU,0xb2b2cd7fU,0x75759feaU,
			0x09091b12U,0x83839e1dU,0x2c2c7458U,0x1a1a2e34U,0x1b1b2d36U,0x6e6eb2dcU,0x5a5aeeb4U,0xa0a0fb5bU,
			0x5252f6a4U,0x3b3b4d76U,0xd6d661b7U,0xb3b3ce7dU,0x29297b52U,0xe3e33eddU,0x2f2f715eU,0x84849713U,
			0x5353f5a6U,0xd1d168b9U,0x00000000U,0xeded2cc1U,0x20206040U,0xfcfc1fe3U,0xb1b1c879U,0x5b5bedb6U,
			0x6a6abed4U,0xcbcb468dU,0xbebed967U,0x39394b72U,0x4a4ade94U,0x4c4cd498U,0x5858e8b0U,0xcfcf4a85U,
			0xd0d06bbbU,0xefef2ac5U,0xaaaae54fU,0xfbfb16edU,0x4343c586U,0x4d4dd79aU,0x33335566U,0x85859411U,
			0x4545cf8aU,0xf9f910e9U,0x02020604U,0x7f7f81feU,0x5050f0a0U,0x3c3c4478U,0x9f9fba25U,0xa8a8e34bU,
			0x5151f3a2U,0xa3a3fe5dU,0x4040c080U,0x8f8f8a05U,0x9292ad3fU,0x9d9dbc21U,0x38384870U,0xf5f504f1U,
			0xbcbcdf63U,0xb6b6c177U,0xdada75afU,0x21216342U,0x10103020U,0xffff1ae5U,0xf3f30efdU,0xd2d26dbfU,
			0xcdcd4c81U,0x0c0c1418U,0x13133526U,0xecec2fc3U,0x5f5fe1beU,0x9797a235U,0x4444cc88U,0x1717392eU,
			0xc4c45793U,0xa7a7f255U,0x7e7e82fcU,0x3d3d477aU,0x6464acc8U,0x5d5de7baU,0x19192b32U,0x737395e6U,
			0x6060a0c0U,0x81819819U,0x4f4fd19eU,0xdcdc7fa3U,0x22226644U,0x2a2a7e54U,0x9090ab3bU,0x8888830bU,
			0x4646ca8cU,0xeeee29c7U,0xb8b8d36bU,0x14143c28U,0xdede79a7U,0x5e5ee2bcU,0x0b0b1d16U,0xdbdb76adU,
			0xe0e03bdbU,0x32325664U,0x3a3a4e74U,0x0a0a1e14U,0x4949db92U,0x06060a0cU,0x24246c48U,0x5c5ce4b8U,
			0xc2c25d9fU,0xd3d36ebdU,0xacacef43U,0x6262a6c4U,0x9191a839U,0x9595a431U,0xe4e437d3U,0x79798bf2U,
			0xe7e732d5U,0xc8c8438bU,0x3737596eU,0x6d6db7daU,0x8d8d8c01U,0xd5d564b1U,0x4e4ed29cU,0xa9a9e049U,
			0x6c6cb4d8U,0x5656faacU,0xf4f407f3U,0xeaea25cfU,0x6565afcaU,0x7a7a8ef4U,0xaeaee947U,0x08081810U,
			0xbabad56fU,0x787888f0U,0x25256f4aU,0x2e2e725cU,0x1c1c2438U,0xa6a6f157U,0xb4b4c773U,0xc6c65197U,
			0xe8e823cbU,0xdddd7ca1U,0x74749ce8U,0x1f1f213eU,0x4b4bdd96U,0xbdbddc61U,0x8b8b860dU,0x8a8a850fU,
			0x707090e0U,0x3e3e427cU,0xb5b5c471U,0x6666aaccU,0x4848d890U,0x03030506U,0xf6f601f7U,0x0e0e121cU,
			0x6161a3c2U,0x35355f6aU,0x5757f9aeU,0xb9b9d069U,0x86869117U,0xc1c15899U,0x1d1d273aU,0x9e9eb927U,
			0xe1e138d9U,0xf8f813ebU,0x9898b32bU,0x11113322U,0x6969bbd2U,0xd9d970a9U,0x8e8e8907U,0x9494a733U,
			0x9b9bb62dU,0x1e1e223cU,0x87879215U,0xe9e920c9U,0xcece4987U,0x5555ffaaU,0x28287850U,0xdfdf7aa5U,
			0x8c8c8f03U,0xa1a1f859U,0x89898009U,0x0d0d171aU,0xbfbfda65U,0xe6e631d7U,0x4242c684U,0x6868b8d0U,
			0x4141c382U,0x9999b029U,0x2d2d775aU,0x0f0f111eU,0xb0b0cb7bU,0x5454fca8U,0xbbbbd66dU,0x16163a2cU
		};
		
	#else
		
		uint32_t tjald_table_0[256]={
			0xA56363C6U,0x847C7CF8U,0x997777EEU,0x8D7B7BF6U,0x0DF2F2FFU,0xBD6B6BD6U,0xB16F6FDEU,0x54C5C591U,
			0x50303060U,0x03010102U,0xA96767CEU,0x7D2B2B56U,0x19FEFEE7U,0x62D7D7B5U,0xE6ABAB4DU,0x9A7676ECU,
			0x45CACA8FU,0x9D82821FU,0x40C9C989U,0x877D7DFAU,0x15FAFAEFU,0xEB5959B2U,0xC947478EU,0x0BF0F0FBU,
			0xECADAD41U,0x67D4D4B3U,0xFDA2A25FU,0xEAAFAF45U,0xBF9C9C23U,0xF7A4A453U,0x967272E4U,0x5BC0C09BU,
			0xC2B7B775U,0x1CFDFDE1U,0xAE93933DU,0x6A26264CU,0x5A36366CU,0x413F3F7EU,0x02F7F7F5U,0x4FCCCC83U,
			0x5C343468U,0xF4A5A551U,0x34E5E5D1U,0x08F1F1F9U,0x937171E2U,0x73D8D8ABU,0x53313162U,0x3F15152AU,
			0x0C040408U,0x52C7C795U,0x65232346U,0x5EC3C39DU,0x28181830U,0xA1969637U,0x0F05050AU,0xB59A9A2FU,
			0x0907070EU,0x36121224U,0x9B80801BU,0x3DE2E2DFU,0x26EBEBCDU,0x6927274EU,0xCDB2B27FU,0x9F7575EAU,
			0x1B090912U,0x9E83831DU,0x742C2C58U,0x2E1A1A34U,0x2D1B1B36U,0xB26E6EDCU,0xEE5A5AB4U,0xFBA0A05BU,
			0xF65252A4U,0x4D3B3B76U,0x61D6D6B7U,0xCEB3B37DU,0x7B292952U,0x3EE3E3DDU,0x712F2F5EU,0x97848413U,
			0xF55353A6U,0x68D1D1B9U,0x00000000U,0x2CEDEDC1U,0x60202040U,0x1FFCFCE3U,0xC8B1B179U,0xED5B5BB6U,
			0xBE6A6AD4U,0x46CBCB8DU,0xD9BEBE67U,0x4B393972U,0xDE4A4A94U,0xD44C4C98U,0xE85858B0U,0x4ACFCF85U,
			0x6BD0D0BBU,0x2AEFEFC5U,0xE5AAAA4FU,0x16FBFBEDU,0xC5434386U,0xD74D4D9AU,0x55333366U,0x94858511U,
			0xCF45458AU,0x10F9F9E9U,0x06020204U,0x817F7FFEU,0xF05050A0U,0x443C3C78U,0xBA9F9F25U,0xE3A8A84BU,
			0xF35151A2U,0xFEA3A35DU,0xC0404080U,0x8A8F8F05U,0xAD92923FU,0xBC9D9D21U,0x48383870U,0x04F5F5F1U,
			0xDFBCBC63U,0xC1B6B677U,0x75DADAAFU,0x63212142U,0x30101020U,0x1AFFFFE5U,0x0EF3F3FDU,0x6DD2D2BFU,
			0x4CCDCD81U,0x140C0C18U,0x35131326U,0x2FECECC3U,0xE15F5FBEU,0xA2979735U,0xCC444488U,0x3917172EU,
			0x57C4C493U,0xF2A7A755U,0x827E7EFCU,0x473D3D7AU,0xAC6464C8U,0xE75D5DBAU,0x2B191932U,0x957373E6U,
			0xA06060C0U,0x98818119U,0xD14F4F9EU,0x7FDCDCA3U,0x66222244U,0x7E2A2A54U,0xAB90903BU,0x8388880BU,
			0xCA46468CU,0x29EEEEC7U,0xD3B8B86BU,0x3C141428U,0x79DEDEA7U,0xE25E5EBCU,0x1D0B0B16U,0x76DBDBADU,
			0x3BE0E0DBU,0x56323264U,0x4E3A3A74U,0x1E0A0A14U,0xDB494992U,0x0A06060CU,0x6C242448U,0xE45C5CB8U,
			0x5DC2C29FU,0x6ED3D3BDU,0xEFACAC43U,0xA66262C4U,0xA8919139U,0xA4959531U,0x37E4E4D3U,0x8B7979F2U,
			0x32E7E7D5U,0x43C8C88BU,0x5937376EU,0xB76D6DDAU,0x8C8D8D01U,0x64D5D5B1U,0xD24E4E9CU,0xE0A9A949U,
			0xB46C6CD8U,0xFA5656ACU,0x07F4F4F3U,0x25EAEACFU,0xAF6565CAU,0x8E7A7AF4U,0xE9AEAE47U,0x18080810U,
			0xD5BABA6FU,0x887878F0U,0x6F25254AU,0x722E2E5CU,0x241C1C38U,0xF1A6A657U,0xC7B4B473U,0x51C6C697U,
			0x23E8E8CBU,0x7CDDDDA1U,0x9C7474E8U,0x211F1F3EU,0xDD4B4B96U,0xDCBDBD61U,0x868B8B0DU,0x858A8A0FU,
			0x907070E0U,0x423E3E7CU,0xC4B5B571U,0xAA6666CCU,0xD8484890U,0x05030306U,0x01F6F6F7U,0x120E0E1CU,
			0xA36161C2U,0x5F35356AU,0xF95757AEU,0xD0B9B969U,0x91868617U,0x58C1C199U,0x271D1D3AU,0xB99E9E27U,
			0x38E1E1D9U,0x13F8F8EBU,0xB398982BU,0x33111122U,0xBB6969D2U,0x70D9D9A9U,0x898E8E07U,0xA7949433U,
			0xB69B9B2DU,0x221E1E3CU,0x92878715U,0x20E9E9C9U,0x49CECE87U,0xFF5555AAU,0x78282850U,0x7ADFDFA5U,
			0x8F8C8C03U,0xF8A1A159U,0x80898909U,0x170D0D1AU,0xDABFBF65U,0x31E6E6D7U,0xC6424284U,0xB86868D0U,
			0xC3414182U,0xB0999929U,0x772D2D5AU,0x110F0F1EU,0xCBB0B07BU,0xFC5454A8U,0xD6BBBB6DU,0x3A16162CU
		};

		uint32_t tjald_table_1[256]={
			0x6363C6A5U,0x7C7CF884U,0x7777EE99U,0x7B7BF68DU,0xF2F2FF0DU,0x6B6BD6BDU,0x6F6FDEB1U,0xC5C59154U,
			0x30306050U,0x01010203U,0x6767CEA9U,0x2B2B567DU,0xFEFEE719U,0xD7D7B562U,0xABAB4DE6U,0x7676EC9AU,
			0xCACA8F45U,0x82821F9DU,0xC9C98940U,0x7D7DFA87U,0xFAFAEF15U,0x5959B2EBU,0x47478EC9U,0xF0F0FB0BU,
			0xADAD41ECU,0xD4D4B367U,0xA2A25FFDU,0xAFAF45EAU,0x9C9C23BFU,0xA4A453F7U,0x7272E496U,0xC0C09B5BU,
			0xB7B775C2U,0xFDFDE11CU,0x93933DAEU,0x26264C6AU,0x36366C5AU,0x3F3F7E41U,0xF7F7F502U,0xCCCC834FU,
			0x3434685CU,0xA5A551F4U,0xE5E5D134U,0xF1F1F908U,0x7171E293U,0xD8D8AB73U,0x31316253U,0x15152A3FU,
			0x0404080CU,0xC7C79552U,0x23234665U,0xC3C39D5EU,0x18183028U,0x969637A1U,0x05050A0FU,0x9A9A2FB5U,
			0x07070E09U,0x12122436U,0x80801B9BU,0xE2E2DF3DU,0xEBEBCD26U,0x27274E69U,0xB2B27FCDU,0x7575EA9FU,
			0x0909121BU,0x83831D9EU,0x2C2C5874U,0x1A1A342EU,0x1B1B362DU,0x6E6EDCB2U,0x5A5AB4EEU,0xA0A05BFBU,
			0x5252A4F6U,0x3B3B764DU,0xD6D6B761U,0xB3B37DCEU,0x2929527BU,0xE3E3DD3EU,0x2F2F5E71U,0x84841397U,
			0x5353A6F5U,0xD1D1B968U,0x00000000U,0xEDEDC12CU,0x20204060U,0xFCFCE31FU,0xB1B179C8U,0x5B5BB6EDU,
			0x6A6AD4BEU,0xCBCB8D46U,0xBEBE67D9U,0x3939724BU,0x4A4A94DEU,0x4C4C98D4U,0x5858B0E8U,0xCFCF854AU,
			0xD0D0BB6BU,0xEFEFC52AU,0xAAAA4FE5U,0xFBFBED16U,0x434386C5U,0x4D4D9AD7U,0x33336655U,0x85851194U,
			0x45458ACFU,0xF9F9E910U,0x02020406U,0x7F7FFE81U,0x5050A0F0U,0x3C3C7844U,0x9F9F25BAU,0xA8A84BE3U,
			0x5151A2F3U,0xA3A35DFEU,0x404080C0U,0x8F8F058AU,0x92923FADU,0x9D9D21BCU,0x38387048U,0xF5F5F104U,
			0xBCBC63DFU,0xB6B677C1U,0xDADAAF75U,0x21214263U,0x10102030U,0xFFFFE51AU,0xF3F3FD0EU,0xD2D2BF6DU,
			0xCDCD814CU,0x0C0C1814U,0x13132635U,0xECECC32FU,0x5F5FBEE1U,0x979735A2U,0x444488CCU,0x17172E39U,
			0xC4C49357U,0xA7A755F2U,0x7E7EFC82U,0x3D3D7A47U,0x6464C8ACU,0x5D5DBAE7U,0x1919322BU,0x7373E695U,
			0x6060C0A0U,0x81811998U,0x4F4F9ED1U,0xDCDCA37FU,0x22224466U,0x2A2A547EU,0x90903BABU,0x88880B83U,
			0x46468CCAU,0xEEEEC729U,0xB8B86BD3U,0x1414283CU,0xDEDEA779U,0x5E5EBCE2U,0x0B0B161DU,0xDBDBAD76U,
			0xE0E0DB3BU,0x32326456U,0x3A3A744EU,0x0A0A141EU,0x494992DBU,0x06060C0AU,0x2424486CU,0x5C5CB8E4U,
			0xC2C29F5DU,0xD3D3BD6EU,0xACAC43EFU,0x6262C4A6U,0x919139A8U,0x959531A4U,0xE4E4D337U,0x7979F28BU,
			0xE7E7D532U,0xC8C88B43U,0x37376E59U,0x6D6DDAB7U,0x8D8D018CU,0xD5D5B164U,0x4E4E9CD2U,0xA9A949E0U,
			0x6C6CD8B4U,0x5656ACFAU,0xF4F4F307U,0xEAEACF25U,0x6565CAAFU,0x7A7AF48EU,0xAEAE47E9U,0x08081018U,
			0xBABA6FD5U,0x7878F088U,0x25254A6FU,0x2E2E5C72U,0x1C1C3824U,0xA6A657F1U,0xB4B473C7U,0xC6C69751U,
			0xE8E8CB23U,0xDDDDA17CU,0x7474E89CU,0x1F1F3E21U,0x4B4B96DDU,0xBDBD61DCU,0x8B8B0D86U,0x8A8A0F85U,
			0x7070E090U,0x3E3E7C42U,0xB5B571C4U,0x6666CCAAU,0x484890D8U,0x03030605U,0xF6F6F701U,0x0E0E1C12U,
			0x6161C2A3U,0x35356A5FU,0x5757AEF9U,0xB9B969D0U,0x86861791U,0xC1C19958U,0x1D1D3A27U,0x9E9E27B9U,
			0xE1E1D938U,0xF8F8EB13U,0x98982BB3U,0x11112233U,0x6969D2BBU,0xD9D9A970U,0x8E8E0789U,0x949433A7U,
			0x9B9B2DB6U,0x1E1E3C22U,0x87871592U,0xE9E9C920U,0xCECE8749U,0x5555AAFFU,0x28285078U,0xDFDFA57AU,
			0x8C8C038FU,0xA1A159F8U,0x89890980U,0x0D0D1A17U,0xBFBF65DAU,0xE6E6D731U,0x424284C6U,0x6868D0B8U,
			0x414182C3U,0x999929B0U,0x2D2D5A77U,0x0F0F1E11U,0xB0B07BCBU,0x5454A8FCU,0xBBBB6DD6U,0x16162C3AU
		};

		uint32_t tjald_table_2[256]={
			0x63C6A563U,0x7CF8847CU,0x77EE9977U,0x7BF68D7BU,0xF2FF0DF2U,0x6BD6BD6BU,0x6FDEB16FU,0xC59154C5U,
			0x30605030U,0x01020301U,0x67CEA967U,0x2B567D2BU,0xFEE719FEU,0xD7B562D7U,0xAB4DE6ABU,0x76EC9A76U,
			0xCA8F45CAU,0x821F9D82U,0xC98940C9U,0x7DFA877DU,0xFAEF15FAU,0x59B2EB59U,0x478EC947U,0xF0FB0BF0U,
			0xAD41ECADU,0xD4B367D4U,0xA25FFDA2U,0xAF45EAAFU,0x9C23BF9CU,0xA453F7A4U,0x72E49672U,0xC09B5BC0U,
			0xB775C2B7U,0xFDE11CFDU,0x933DAE93U,0x264C6A26U,0x366C5A36U,0x3F7E413FU,0xF7F502F7U,0xCC834FCCU,
			0x34685C34U,0xA551F4A5U,0xE5D134E5U,0xF1F908F1U,0x71E29371U,0xD8AB73D8U,0x31625331U,0x152A3F15U,
			0x04080C04U,0xC79552C7U,0x23466523U,0xC39D5EC3U,0x18302818U,0x9637A196U,0x050A0F05U,0x9A2FB59AU,
			0x070E0907U,0x12243612U,0x801B9B80U,0xE2DF3DE2U,0xEBCD26EBU,0x274E6927U,0xB27FCDB2U,0x75EA9F75U,
			0x09121B09U,0x831D9E83U,0x2C58742CU,0x1A342E1AU,0x1B362D1BU,0x6EDCB26EU,0x5AB4EE5AU,0xA05BFBA0U,
			0x52A4F652U,0x3B764D3BU,0xD6B761D6U,0xB37DCEB3U,0x29527B29U,0xE3DD3EE3U,0x2F5E712FU,0x84139784U,
			0x53A6F553U,0xD1B968D1U,0x00000000U,0xEDC12CEDU,0x20406020U,0xFCE31FFCU,0xB179C8B1U,0x5BB6ED5BU,
			0x6AD4BE6AU,0xCB8D46CBU,0xBE67D9BEU,0x39724B39U,0x4A94DE4AU,0x4C98D44CU,0x58B0E858U,0xCF854ACFU,
			0xD0BB6BD0U,0xEFC52AEFU,0xAA4FE5AAU,0xFBED16FBU,0x4386C543U,0x4D9AD74DU,0x33665533U,0x85119485U,
			0x458ACF45U,0xF9E910F9U,0x02040602U,0x7FFE817FU,0x50A0F050U,0x3C78443CU,0x9F25BA9FU,0xA84BE3A8U,
			0x51A2F351U,0xA35DFEA3U,0x4080C040U,0x8F058A8FU,0x923FAD92U,0x9D21BC9DU,0x38704838U,0xF5F104F5U,
			0xBC63DFBCU,0xB677C1B6U,0xDAAF75DAU,0x21426321U,0x10203010U,0xFFE51AFFU,0xF3FD0EF3U,0xD2BF6DD2U,
			0xCD814CCDU,0x0C18140CU,0x13263513U,0xECC32FECU,0x5FBEE15FU,0x9735A297U,0x4488CC44U,0x172E3917U,
			0xC49357C4U,0xA755F2A7U,0x7EFC827EU,0x3D7A473DU,0x64C8AC64U,0x5DBAE75DU,0x19322B19U,0x73E69573U,
			0x60C0A060U,0x81199881U,0x4F9ED14FU,0xDCA37FDCU,0x22446622U,0x2A547E2AU,0x903BAB90U,0x880B8388U,
			0x468CCA46U,0xEEC729EEU,0xB86BD3B8U,0x14283C14U,0xDEA779DEU,0x5EBCE25EU,0x0B161D0BU,0xDBAD76DBU,
			0xE0DB3BE0U,0x32645632U,0x3A744E3AU,0x0A141E0AU,0x4992DB49U,0x060C0A06U,0x24486C24U,0x5CB8E45CU,
			0xC29F5DC2U,0xD3BD6ED3U,0xAC43EFACU,0x62C4A662U,0x9139A891U,0x9531A495U,0xE4D337E4U,0x79F28B79U,
			0xE7D532E7U,0xC88B43C8U,0x376E5937U,0x6DDAB76DU,0x8D018C8DU,0xD5B164D5U,0x4E9CD24EU,0xA949E0A9U,
			0x6CD8B46CU,0x56ACFA56U,0xF4F307F4U,0xEACF25EAU,0x65CAAF65U,0x7AF48E7AU,0xAE47E9AEU,0x08101808U,
			0xBA6FD5BAU,0x78F08878U,0x254A6F25U,0x2E5C722EU,0x1C38241CU,0xA657F1A6U,0xB473C7B4U,0xC69751C6U,
			0xE8CB23E8U,0xDDA17CDDU,0x74E89C74U,0x1F3E211FU,0x4B96DD4BU,0xBD61DCBDU,0x8B0D868BU,0x8A0F858AU,
			0x70E09070U,0x3E7C423EU,0xB571C4B5U,0x66CCAA66U,0x4890D848U,0x03060503U,0xF6F701F6U,0x0E1C120EU,
			0x61C2A361U,0x356A5F35U,0x57AEF957U,0xB969D0B9U,0x86179186U,0xC19958C1U,0x1D3A271DU,0x9E27B99EU,
			0xE1D938E1U,0xF8EB13F8U,0x982BB398U,0x11223311U,0x69D2BB69U,0xD9A970D9U,0x8E07898EU,0x9433A794U,
			0x9B2DB69BU,0x1E3C221EU,0x87159287U,0xE9C920E9U,0xCE8749CEU,0x55AAFF55U,0x28507828U,0xDFA57ADFU,
			0x8C038F8CU,0xA159F8A1U,0x89098089U,0x0D1A170DU,0xBF65DABFU,0xE6D731E6U,0x4284C642U,0x68D0B868U,
			0x4182C341U,0x9929B099U,0x2D5A772DU,0x0F1E110FU,0xB07BCBB0U,0x54A8FC54U,0xBB6DD6BBU,0x162C3A16U
		};

		uint32_t tjald_table_3[256]={
			0xC6A56363U,0xF8847C7CU,0xEE997777U,0xF68D7B7BU,0xFF0DF2F2U,0xD6BD6B6BU,0xDEB16F6FU,0x9154C5C5U,
			0x60503030U,0x02030101U,0xCEA96767U,0x567D2B2BU,0xE719FEFEU,0xB562D7D7U,0x4DE6ABABU,0xEC9A7676U,
			0x8F45CACAU,0x1F9D8282U,0x8940C9C9U,0xFA877D7DU,0xEF15FAFAU,0xB2EB5959U,0x8EC94747U,0xFB0BF0F0U,
			0x41ECADADU,0xB367D4D4U,0x5FFDA2A2U,0x45EAAFAFU,0x23BF9C9CU,0x53F7A4A4U,0xE4967272U,0x9B5BC0C0U,
			0x75C2B7B7U,0xE11CFDFDU,0x3DAE9393U,0x4C6A2626U,0x6C5A3636U,0x7E413F3FU,0xF502F7F7U,0x834FCCCCU,
			0x685C3434U,0x51F4A5A5U,0xD134E5E5U,0xF908F1F1U,0xE2937171U,0xAB73D8D8U,0x62533131U,0x2A3F1515U,
			0x080C0404U,0x9552C7C7U,0x46652323U,0x9D5EC3C3U,0x30281818U,0x37A19696U,0x0A0F0505U,0x2FB59A9AU,
			0x0E090707U,0x24361212U,0x1B9B8080U,0xDF3DE2E2U,0xCD26EBEBU,0x4E692727U,0x7FCDB2B2U,0xEA9F7575U,
			0x121B0909U,0x1D9E8383U,0x58742C2CU,0x342E1A1AU,0x362D1B1BU,0xDCB26E6EU,0xB4EE5A5AU,0x5BFBA0A0U,
			0xA4F65252U,0x764D3B3BU,0xB761D6D6U,0x7DCEB3B3U,0x527B2929U,0xDD3EE3E3U,0x5E712F2FU,0x13978484U,
			0xA6F55353U,0xB968D1D1U,0x00000000U,0xC12CEDEDU,0x40602020U,0xE31FFCFCU,0x79C8B1B1U,0xB6ED5B5BU,
			0xD4BE6A6AU,0x8D46CBCBU,0x67D9BEBEU,0x724B3939U,0x94DE4A4AU,0x98D44C4CU,0xB0E85858U,0x854ACFCFU,
			0xBB6BD0D0U,0xC52AEFEFU,0x4FE5AAAAU,0xED16FBFBU,0x86C54343U,0x9AD74D4DU,0x66553333U,0x11948585U,
			0x8ACF4545U,0xE910F9F9U,0x04060202U,0xFE817F7FU,0xA0F05050U,0x78443C3CU,0x25BA9F9FU,0x4BE3A8A8U,
			0xA2F35151U,0x5DFEA3A3U,0x80C04040U,0x058A8F8FU,0x3FAD9292U,0x21BC9D9DU,0x70483838U,0xF104F5F5U,
			0x63DFBCBCU,0x77C1B6B6U,0xAF75DADAU,0x42632121U,0x20301010U,0xE51AFFFFU,0xFD0EF3F3U,0xBF6DD2D2U,
			0x814CCDCDU,0x18140C0CU,0x26351313U,0xC32FECECU,0xBEE15F5FU,0x35A29797U,0x88CC4444U,0x2E391717U,
			0x9357C4C4U,0x55F2A7A7U,0xFC827E7EU,0x7A473D3DU,0xC8AC6464U,0xBAE75D5DU,0x322B1919U,0xE6957373U,
			0xC0A06060U,0x19988181U,0x9ED14F4FU,0xA37FDCDCU,0x44662222U,0x547E2A2AU,0x3BAB9090U,0x0B838888U,
			0x8CCA4646U,0xC729EEEEU,0x6BD3B8B8U,0x283C1414U,0xA779DEDEU,0xBCE25E5EU,0x161D0B0BU,0xAD76DBDBU,
			0xDB3BE0E0U,0x64563232U,0x744E3A3AU,0x141E0A0AU,0x92DB4949U,0x0C0A0606U,0x486C2424U,0xB8E45C5CU,
			0x9F5DC2C2U,0xBD6ED3D3U,0x43EFACACU,0xC4A66262U,0x39A89191U,0x31A49595U,0xD337E4E4U,0xF28B7979U,
			0xD532E7E7U,0x8B43C8C8U,0x6E593737U,0xDAB76D6DU,0x018C8D8DU,0xB164D5D5U,0x9CD24E4EU,0x49E0A9A9U,
			0xD8B46C6CU,0xACFA5656U,0xF307F4F4U,0xCF25EAEAU,0xCAAF6565U,0xF48E7A7AU,0x47E9AEAEU,0x10180808U,
			0x6FD5BABAU,0xF0887878U,0x4A6F2525U,0x5C722E2EU,0x38241C1CU,0x57F1A6A6U,0x73C7B4B4U,0x9751C6C6U,
			0xCB23E8E8U,0xA17CDDDDU,0xE89C7474U,0x3E211F1FU,0x96DD4B4BU,0x61DCBDBDU,0x0D868B8BU,0x0F858A8AU,
			0xE0907070U,0x7C423E3EU,0x71C4B5B5U,0xCCAA6666U,0x90D84848U,0x06050303U,0xF701F6F6U,0x1C120E0EU,
			0xC2A36161U,0x6A5F3535U,0xAEF95757U,0x69D0B9B9U,0x17918686U,0x9958C1C1U,0x3A271D1DU,0x27B99E9EU,
			0xD938E1E1U,0xEB13F8F8U,0x2BB39898U,0x22331111U,0xD2BB6969U,0xA970D9D9U,0x07898E8EU,0x33A79494U,
			0x2DB69B9BU,0x3C221E1EU,0x15928787U,0xC920E9E9U,0x8749CECEU,0xAAFF5555U,0x50782828U,0xA57ADFDFU,
			0x038F8C8CU,0x59F8A1A1U,0x09808989U,0x1A170D0DU,0x65DABFBFU,0xD731E6E6U,0x84C64242U,0xD0B86868U,
			0x82C34141U,0x29B09999U,0x5A772D2DU,0x1E110F0FU,0x7BCBB0B0U,0xA8FC5454U,0x6DD6BBBBU,0x2C3A1616U
		};
		
	#endif
	
	void tjald_2_begin_c(tjald_2_state* state,const uint8_t key[704]){
		if(key==(uint8_t*)0){
			key=tjald_seed;
		}
		uint8_t* statetype=(uint8_t*)state;
		memcpy(statetype,key,704);
		memset(statetype+704,0,64);
	}

	void tjald_3_begin_c(tjald_3_state* state,const uint8_t key[704]){
		if(key==(uint8_t*)0){
			key=tjald_seed;
		}
		uint8_t* statetype=(uint8_t*)state;
		memcpy(statetype,key,704);
		memset(statetype+704,0,320);
	}

	void tjald_4_begin_c(tjald_4_state* state){
		uint8_t* statetype=(uint8_t*)state;
		memcpy(statetype,tjald_seed,704);
		memset(statetype+704,0,320);
	}

	#if defined(TJALD_BIG_ENDIAN)
		#define tjald_aesenc_c(D,A,B,C) \
			t0=(A)[0]^(B)[0];t1=(A)[1]^(B)[1];t2=(A)[2]^(B)[2];t3=(A)[3]^(B)[3]; \
			(D)[0]=tjald_table_0[t3>>24]^tjald_table_1[(t2>>16)&0xff] \
			^tjald_table_2[(t1>>8)&0xff]^tjald_table_3[t0&0xff]^(C)[0]; \
			(D)[1]=tjald_table_0[t0>>24]^tjald_table_1[(t3>>16)&0xff] \
			^tjald_table_2[(t2>>8)&0xff]^tjald_table_3[t1&0xff]^(C)[1]; \
			(D)[2]=tjald_table_0[t1>>24]^tjald_table_1[(t0>>16)&0xff] \
			^tjald_table_2[(t3>>8)&0xff]^tjald_table_3[t2&0xff]^(C)[2]; \
			(D)[3]=tjald_table_0[t2>>24]^tjald_table_1[(t1>>16)&0xff] \
			^tjald_table_2[(t0>>8)&0xff]^tjald_table_3[t3&0xff]^(C)[3];
	#else
		#define tjald_aesenc_c(D,A,B,C) \
			t0=(A)[0]^(B)[0];t1=(A)[1]^(B)[1];t2=(A)[2]^(B)[2];t3=(A)[3]^(B)[3]; \
			(D)[0]=tjald_table_3[t3>>24]^tjald_table_2[(t2>>16)&0xff] \
			^tjald_table_1[(t1>>8)&0xff]^tjald_table_0[t0&0xff]^(C)[0]; \
			(D)[1]=tjald_table_3[t0>>24]^tjald_table_2[(t3>>16)&0xff] \
			^tjald_table_1[(t2>>8)&0xff]^tjald_table_0[t1&0xff]^(C)[1]; \
			(D)[2]=tjald_table_3[t1>>24]^tjald_table_2[(t0>>16)&0xff] \
			^tjald_table_1[(t3>>8)&0xff]^tjald_table_0[t2&0xff]^(C)[2]; \
			(D)[3]=tjald_table_3[t2>>24]^tjald_table_2[(t1>>16)&0xff] \
			^tjald_table_1[(t0>>8)&0xff]^tjald_table_0[t3&0xff]^(C)[3];
	#endif
		
	#define tjald_add_c(D,A,B) \
		(D)[0]=(((A)[0]&0x7f7f7f7fU)+((B)[0]&0x7f7f7f7fU))^(((A)[0]^(B)[0])&0x80808080U); \
		(D)[1]=(((A)[1]&0x7f7f7f7fU)+((B)[1]&0x7f7f7f7fU))^(((A)[1]^(B)[1])&0x80808080U); \
		(D)[2]=(((A)[2]&0x7f7f7f7fU)+((B)[2]&0x7f7f7f7fU))^(((A)[2]^(B)[2])&0x80808080U); \
		(D)[3]=(((A)[3]&0x7f7f7f7fU)+((B)[3]&0x7f7f7f7fU))^(((A)[3]^(B)[3])&0x80808080U);
		
	#define tjald_sub_c(D,A,B) \
		(D)[0]=(((A)[0]|0x80808080U)-((B)[0]&0x7f7f7f7fU))^((~(A)[0]^(B)[0])&0x80808080U); \
		(D)[1]=(((A)[1]|0x80808080U)-((B)[1]&0x7f7f7f7fU))^((~(A)[1]^(B)[1])&0x80808080U); \
		(D)[2]=(((A)[2]|0x80808080U)-((B)[2]&0x7f7f7f7fU))^((~(A)[2]^(B)[2])&0x80808080U); \
		(D)[3]=(((A)[3]|0x80808080U)-((B)[3]&0x7f7f7f7fU))^((~(A)[3]^(B)[3])&0x80808080U);
		
	#define tjald_and_c(D,A,B) \
		(D)[0]=(A)[0]&(B)[0]; \
		(D)[1]=(A)[1]&(B)[1]; \
		(D)[2]=(A)[2]&(B)[2]; \
		(D)[3]=(A)[3]&(B)[3];
		
	#define tjald_lane(x) (state4+(x)*lanewidth4)
	
	void tjald_adaptive_kernel_c(uint8_t* state,const uint8_t* input,size_t bunches,size_t lanewidth){
		uint64_t offset0_p;
		uint64_t offset1_p;
		uint64_t advancement_p;
		uint64_t rounds_p;
		uint64_t laststate[22];
		size_t a;
		if(bunches==5){
			offset0_p=0x019001001000000ULL*lanewidth;
			offset1_p=0x018000003002001ULL*lanewidth;
			advancement_p=0x002002004004002ULL*lanewidth;
			rounds_p=0x005003004004008ULL;
			for(a=0;a<11;a++){
				laststate[a*2]=((uint64_t*)(state+a*lanewidth))[0];
				laststate[a*2+1]=((uint64_t*)(state+a*lanewidth))[1];
			}
		}
		else if(bunches==3){
			offset0_p=0x011001000ULL*lanewidth;
			offset1_p=0x010000001ULL*lanewidth;
			advancement_p=0x002002002ULL*lanewidth;
			rounds_p=0x002002004ULL;
		}
		else{
			offset0_p=0;
			offset1_p=1*lanewidth;
			advancement_p=2*lanewidth;
			rounds_p=bunches>>1;
			bunches=1;
		}

		size_t lanewidth4=lanewidth>>2;
		uint32_t t0,t1,t2,t3;
		uint32_t l0[4];
		uint32_t l1[4];
		uint32_t* state4=(uint32_t*)state;
		uint32_t lanetmp[4];
		uint32_t* symmetrybreaker=(uint32_t*)tjald_small_seed;
		size_t bunches_o=bunches;
		while(bunches>0){
			size_t offset0=offset0_p&4095;
			offset0_p>>=12;
			size_t offset1=offset1_p&4095;
			offset1_p>>=12;
			size_t advancement=advancement_p&4095;
			advancement_p>>=12;
			size_t rounds=rounds_p&4095;
			rounds_p>>=12;
			const uint8_t* input0=input+offset0;
			const uint8_t* input1=input+offset1;
			while(rounds>0){
				memcpy(l0,input0,16);
				memcpy(l1,input1,16);
				input0+=advancement;
				input1+=advancement;
				tjald_aesenc_c(lanetmp,tjald_lane(0),l0,tjald_lane(4));
				tjald_aesenc_c(tjald_lane(0),tjald_lane(4),l1,tjald_lane(8));
				tjald_aesenc_c(tjald_lane(4),tjald_lane(8),l1,tjald_lane(1));
				tjald_add_c(tjald_lane(10),tjald_lane(10),l0);
				memcpy(l0,input0,16);
				memcpy(l1,input1,16);
				input0+=advancement;
				input1+=advancement;
				tjald_aesenc_c(tjald_lane(8),tjald_lane(1),l0,tjald_lane(5));
				tjald_aesenc_c(tjald_lane(1),tjald_lane(5),l1,tjald_lane(9));
				tjald_aesenc_c(tjald_lane(5),tjald_lane(9),l1,tjald_lane(2));
				tjald_add_c(lanetmp,lanetmp,l0);
				memcpy(l0,input0,16);
				memcpy(l1,input1,16);
				input0+=advancement;
				input1+=advancement;
				tjald_aesenc_c(tjald_lane(9),tjald_lane(2),l0,tjald_lane(6));
				tjald_aesenc_c(tjald_lane(2),tjald_lane(6),l1,tjald_lane(10));
				tjald_aesenc_c(tjald_lane(6),tjald_lane(10),l1,tjald_lane(3));
				tjald_add_c(tjald_lane(8),tjald_lane(8),l0);
				memcpy(l0,input0,16);
				memcpy(l1,input1,16);
				input0+=advancement;
				input1+=advancement;
				tjald_aesenc_c(tjald_lane(10),tjald_lane(3),l0,tjald_lane(7));
				tjald_aesenc_c(tjald_lane(3),tjald_lane(7),l1,lanetmp);
				tjald_aesenc_c(tjald_lane(7),lanetmp,l1,tjald_lane(0));
				tjald_add_c(tjald_lane(9),tjald_lane(9),l0);
				
				rounds--;
			}
			bunches--;
			if(bunches_o==3){
				switch(bunches){
					case 0:
						tjald_sub_c(tjald_lane(2),tjald_lane(2),symmetrybreaker);
						break;
					case 1:
						tjald_add_c(tjald_lane(2),tjald_lane(2),symmetrybreaker);
						break;
					case 2:
						tjald_add_c(tjald_lane(6),tjald_lane(6),symmetrybreaker);
						break;
				}
			}
			else if(bunches_o==5){
				switch(bunches){
					case 0:
						tjald_sub_c(tjald_lane(2),tjald_lane(2),symmetrybreaker);
						break;
					case 1:
						tjald_sub_c(tjald_lane(2),tjald_lane(2),symmetrybreaker);
						break;
					case 2:
						tjald_sub_c(tjald_lane(6),tjald_lane(6),symmetrybreaker);
						break;
					case 3:
						tjald_add_c(tjald_lane(2),tjald_lane(2),symmetrybreaker);
						break;
					case 4:
						tjald_add_c(tjald_lane(6),tjald_lane(6),symmetrybreaker);
						break;
				}
			}
		}
		if(bunches_o==5){
			for(a=0;a<11;a++){
				((uint64_t*)(state+a*lanewidth))[0]^=laststate[a*2];
				((uint64_t*)(state+a*lanewidth))[1]^=laststate[a*2+1];
			}
		}
	}
	
	void tjald_adaptive_final_c(uint8_t* state,size_t rounds,uint8_t out[64]){
		uint32_t lanetmp[4];
		size_t lanewidth4=4;
		uint32_t* state4=(uint32_t*)state;
		uint32_t t0,t1,t2,t3;
		while(rounds>0){

			tjald_aesenc_c(lanetmp,tjald_lane(0),tjald_lane(8),tjald_lane(4));
			tjald_aesenc_c(tjald_lane(0),tjald_lane(4),tjald_lane(1),tjald_lane(8));
			tjald_aesenc_c(tjald_lane(4),tjald_lane(8),tjald_lane(10),tjald_lane(2));
			tjald_add_c(tjald_lane(9),tjald_lane(9),tjald_lane(10));

			tjald_aesenc_c(tjald_lane(8),tjald_lane(1),tjald_lane(9),tjald_lane(5));
			tjald_aesenc_c(tjald_lane(1),tjald_lane(5),tjald_lane(2),tjald_lane(9));
			tjald_aesenc_c(tjald_lane(5),tjald_lane(9),lanetmp,tjald_lane(3));
			tjald_add_c(tjald_lane(10),tjald_lane(10),lanetmp);

			tjald_aesenc_c(tjald_lane(9),tjald_lane(2),tjald_lane(10),tjald_lane(6));
			tjald_aesenc_c(tjald_lane(2),tjald_lane(6),tjald_lane(3),tjald_lane(10));
			tjald_aesenc_c(tjald_lane(6),tjald_lane(10),tjald_lane(8),tjald_lane(0));
			tjald_add_c(lanetmp,lanetmp,tjald_lane(8));

			tjald_aesenc_c(tjald_lane(10),tjald_lane(3),lanetmp,tjald_lane(7));
			tjald_aesenc_c(tjald_lane(3),tjald_lane(7),tjald_lane(0),lanetmp);
			tjald_aesenc_c(tjald_lane(7),lanetmp,tjald_lane(9),tjald_lane(1));
			tjald_add_c(tjald_lane(8),tjald_lane(8),tjald_lane(9));
			
			rounds--;
		}
		tjald_add_c(tjald_lane(0),tjald_lane(0),tjald_lane(1));
		tjald_add_c(tjald_lane(2),tjald_lane(2),tjald_lane(3));
		tjald_add_c(tjald_lane(4),tjald_lane(4),tjald_lane(5));
		tjald_add_c(tjald_lane(6),tjald_lane(6),tjald_lane(8));
		tjald_add_c(tjald_lane(7),tjald_lane(7),tjald_lane(10));
		tjald_lane(0)[0]^=tjald_lane(6)[0];
		tjald_lane(0)[1]^=tjald_lane(6)[1];
		tjald_lane(0)[2]^=tjald_lane(6)[2];
		tjald_lane(0)[3]^=tjald_lane(6)[3];
		tjald_lane(2)[0]^=tjald_lane(9)[0];
		tjald_lane(2)[1]^=tjald_lane(9)[1];
		tjald_lane(2)[2]^=tjald_lane(9)[2];
		tjald_lane(2)[3]^=tjald_lane(9)[3];
		memcpy(out,tjald_lane(0),16);
		memcpy(out+16,tjald_lane(2),16);
		memcpy(out+32,tjald_lane(4),16);
		memcpy(out+48,tjald_lane(7),16);
	}
	
	void tjald_2_absorb_c(tjald_2_state* state,const void* input,size_t input_length){
		const uint8_t* input8=(uint8_t*)input;
		size_t a;
		size_t length=*(uint32_t*)(state->state+764);
		size_t bufferlength=length&511;
		length=(length+input_length)|((((input_length>=4096)<<31)|length)&0x80000000U);
		*(uint32_t*)(state->state+764)=(uint32_t)length;
		if(bufferlength>0){
			size_t tocopy=512-bufferlength;
			if(input_length<tocopy){
				memcpy(state->buffer+bufferlength,input8,input_length);
				return;
			}
			else{
				memcpy(state->buffer+bufferlength,input8,tocopy);
				for(a=0;a<64;a+=16){
					tjald_adaptive_kernel_c(state->state+a,state->buffer+a,2,64);
				}
				input8+=tocopy;
				input_length-=tocopy;
			}
		}
		size_t block32=input_length>>14;
		while(block32>0){
			for(a=0;a<64;a+=16){
				tjald_adaptive_kernel_c(state->state+a,input8+a,64,64);
			}
			input8+=1<<14;
			block32--;
		}
		input_length&=(1<<14)-1;
		size_t fullblocks=input_length>>9;
		if(fullblocks>0){
			for(a=0;a<64;a+=16){
				tjald_adaptive_kernel_c(state->state+a,input8+a,fullblocks*2,64);
			}
			input8+=fullblocks<<9;
			input_length&=511;
		}
		memcpy(state->buffer,input8,input_length);
	}
	
	void tjald_3_absorb_c(tjald_3_state* state,const void* input,size_t input_length){
		const uint8_t* input8=(uint8_t*)input;
		size_t a;
		size_t length=*(uint32_t*)(state->state+1020);
		size_t bufferlength=length&2047;
		length=(length+input_length)|((((input_length>=4096)<<31)|length)&0x80000000U);
		*(uint32_t*)(state->state+1020)=(uint32_t)length;
		if(bufferlength>0){
			size_t tocopy=2048-bufferlength;
			if(input_length<tocopy){
				memcpy(state->buffer+bufferlength,input8,input_length);
				return;
			}
			else{
				memcpy(state->buffer+bufferlength,input8,tocopy);
				for(a=0;a<64;a+=16){
					tjald_adaptive_kernel_c(state->state+a,state->buffer+a,3,64);
				}
				input8+=tocopy;
				input_length-=tocopy;
			}
		}
		while(input_length>=(1<<11)){
			for(a=0;a<64;a+=16){
				tjald_adaptive_kernel_c(state->state+a,input8+a,3,64);
			}
			input8+=1<<11;
			input_length-=1<<11;
		}
		memcpy(state->buffer,input8,input_length);
	}
	
	void tjald_4_absorb_c(tjald_4_state* state,const void* input,size_t input_length){
		const uint8_t* input8=(uint8_t*)input;
		size_t a;
		size_t length=*(uint32_t*)(state->state+1020);
		size_t bufferlength=length&4095;
		length=(length+input_length)|((((input_length>=4096)<<31)|length)&0x80000000U);
		*(uint32_t*)(state->state+1020)=(uint32_t)length;
		if(bufferlength>0){
			size_t tocopy=4096-bufferlength;
			if(input_length<tocopy){
				memcpy(state->buffer+bufferlength,input8,input_length);
				return;
			}
			else{
				memcpy(state->buffer+bufferlength,input8,tocopy);
				for(a=0;a<64;a+=16){
					tjald_adaptive_kernel_c(state->state+a,state->buffer+a,5,64);
				}
				input8+=tocopy;
				input_length-=tocopy;
			}
		}
		while(input_length>=(1<<12)){
			for(a=0;a<64;a+=16){
				tjald_adaptive_kernel_c(state->state+a,input8+a,5,64);
			}
			input8+=1<<12;
			input_length-=1<<12;
		}
		memcpy(state->buffer,input8,input_length);
	}
	
	void tjald_2_end_c(tjald_2_state* state,uint8_t out[64]){
		size_t a;
		uint32_t length=*(uint32_t*)(state->state+764);
		size_t bufferlength=length&511;
		
		uint8_t* newlanes;
		uint8_t* newbuffer;
		size_t newbuffercount;
		if(length<=508){
			newbuffercount=(length+4+127)>>7;
			uint8_t* zerospot=state->buffer+bufferlength;
			size_t zerolength=(newbuffercount<<7)-bufferlength-4;
			memset(zerospot,0,zerolength);
			#if defined(TJALD_BIG_ENDIAN)
				((uint32_t*)(zerospot+zerolength))[0]=tjald_inverse_endianess_32(length);
			#else
				((uint32_t*)(zerospot+zerolength))[0]=length;
			#endif
			newlanes=state->state;
			newbuffer=state->buffer;
		}
		else{
			if(bufferlength>0){
				uint8_t* zerospot=state->buffer+bufferlength;
				size_t zerolength=512-bufferlength;
				memset(zerospot,0,zerolength);
				for(a=0;a<64;a+=16){
					tjald_adaptive_kernel_c(state->state+a,state->buffer+a,2,64);
				}
			}
			memcpy(state->buffer,tjald_seed,176);
			newlanes=state->buffer;
			newbuffer=state->state;
			newbuffercount=6;
			#if defined(TJALD_BIG_ENDIAN)
				*(uint32_t*)(state->state+764)=tjald_inverse_endianess_32(length|0x80000000U);
			#else
				*(uint32_t*)(state->state+764)=length|0x80000000U;
			#endif
		}
		tjald_adaptive_kernel_c(newlanes,newbuffer,2*newbuffercount,16);
		tjald_adaptive_final_c(newlanes,4,out);
	}
	
	void tjald_3_end_c(tjald_3_state* state,uint8_t out[64]){
		size_t a;
		uint32_t length=*(uint32_t*)(state->state+1020);
		size_t bufferlength=length&2047;
		
		uint8_t* newlanes;
		uint8_t* newbuffer;
		size_t newbuffercount;
		if(length<=2044){
			newbuffercount=(length+4+511)>>9;
			uint8_t* zerospot=state->buffer+bufferlength;
			size_t zerolength=(newbuffercount<<9)-bufferlength-4;
			memset(zerospot,0,zerolength);
			#if defined(TJALD_BIG_ENDIAN)
				((uint32_t*)(zerospot+zerolength))[0]=tjald_inverse_endianess_32(length);
			#else
				((uint32_t*)(zerospot+zerolength))[0]=length;
			#endif
			newlanes=state->state;
			newbuffer=state->buffer;
		}
		else{
			if(bufferlength>0){
				uint8_t* zerospot=state->buffer+bufferlength;
				size_t zerolength=2048-bufferlength;
				memset(zerospot,0,zerolength);
				for(a=0;a<64;a+=16){
					tjald_adaptive_kernel_c(state->state+a,state->buffer+a,3,64);
				}
			}
			memcpy(state->buffer,tjald_seed,176);
			newlanes=state->buffer;
			newbuffer=state->state;
			newbuffercount=2;
			#if defined(TJALD_BIG_ENDIAN)
				*(uint32_t*)(state->state+1020)=tjald_inverse_endianess_32(length|0x80000000U);
			#else
				*(uint32_t*)(state->state+1020)=length|0x80000000U;
			#endif
		}
		while(newbuffercount>0){
			tjald_adaptive_kernel_c(newlanes,newbuffer,3,16);
			newbuffer+=512;
			newbuffercount--;
		}
		tjald_adaptive_final_c(newlanes,6,out);
	}
	
	void tjald_4_end_c(tjald_4_state* state,uint8_t out[64]){
		size_t a;
		uint32_t length=*(uint32_t*)(state->state+1020);
		size_t bufferlength=length&4095;
		
		uint8_t* newlanes;
		uint8_t* newbuffer;
		size_t newbuffercount;
		if(length<=4092){
			newbuffercount=(length+4+1023)>>10;
			uint8_t* zerospot=state->buffer+bufferlength;
			size_t zerolength=(newbuffercount<<10)-bufferlength-4;
			memset(zerospot,0,zerolength);
			#if defined(TJALD_BIG_ENDIAN)
				((uint32_t*)(zerospot+zerolength))[0]=tjald_inverse_endianess_32(length);
			#else
				((uint32_t*)(zerospot+zerolength))[0]=length;
			#endif
			newlanes=state->state;
			newbuffer=state->buffer;
		}
		else{
			if(bufferlength>0){
				uint8_t* zerospot=state->buffer+bufferlength;
				size_t zerolength=4096-bufferlength;
				memset(zerospot,0,zerolength);
				for(a=0;a<64;a+=16){
					tjald_adaptive_kernel_c(state->state+a,state->buffer+a,5,64);
				}
			}
			memcpy(state->buffer,tjald_seed,176);
			newlanes=state->buffer;
			newbuffer=state->state;
			newbuffercount=1;
			#if defined(TJALD_BIG_ENDIAN)
				*(uint32_t*)(state->state+1020)=tjald_inverse_endianess_32(length|0x80000000U);
			#else
				*(uint32_t*)(state->state+1020)=length|0x80000000U;
			#endif
		}
		while(newbuffercount>0){
			tjald_adaptive_kernel_c(newlanes,newbuffer,5,16);
			newbuffer+=1024;
			newbuffercount--;
		}
		tjald_adaptive_final_c(newlanes,8,out);
	}
	
	void tjald_2_c(const uint8_t key[704],const void* input,size_t input_length,uint8_t out[64]){
		tjald_2_state state;
		tjald_2_begin_c(&state,key);
		tjald_2_absorb_c(&state,input,input_length);
		tjald_2_end_c(&state,out);
	}

	void tjald_3_c(const uint8_t key[704],const void* input,size_t input_length,uint8_t out[64]){
		tjald_3_state state;
		tjald_3_begin_c(&state,key);
		tjald_3_absorb_c(&state,input,input_length);
		tjald_3_end_c(&state,out);
	}

	void tjald_4_c(const void* input,size_t input_length,uint8_t out[64]){
		tjald_4_state state;
		tjald_4_begin_c(&state);
		tjald_4_absorb_c(&state,input,input_length);
		tjald_4_end_c(&state,out);
	}
	
	void gesus_adaptive_advance_c(uint8_t* state,uint8_t* secret,uint8_t* out,size_t lanewidth){
		uint32_t lanetmp[4];
		size_t lanewidth4=lanewidth>>2;
		uint32_t* state4=(uint32_t*)state;
		uint32_t t0,t1,t2,t3;
		size_t a;
		uint32_t l0[4];
		for(a=0;a<16;a++){
			memcpy(l0,secret,16);
			memcpy(secret,tjald_lane(8),16);
			tjald_aesenc_c(lanetmp,tjald_lane(0),l0,tjald_lane(4));
			tjald_aesenc_c(tjald_lane(0),tjald_lane(4),l0,tjald_lane(8));
			tjald_aesenc_c(tjald_lane(4),tjald_lane(8),l0,tjald_lane(1));
			tjald_add_c(tjald_lane(10),tjald_lane(10),l0);
			tjald_and_c(l0,l0,tjald_lane(1));
			tjald_aesenc_c(l0,l0,tjald_lane(5),tjald_lane(9));
			memcpy(out,l0,16);
			secret+=lanewidth;
			out+=lanewidth;
			
			memcpy(l0,secret,16);
			memcpy(secret,tjald_lane(9),16);
			tjald_aesenc_c(tjald_lane(8),tjald_lane(1),l0,tjald_lane(5));
			tjald_aesenc_c(tjald_lane(1),tjald_lane(5),l0,tjald_lane(9));
			tjald_aesenc_c(tjald_lane(5),tjald_lane(9),l0,tjald_lane(2));
			tjald_add_c(lanetmp,lanetmp,l0);
			tjald_and_c(l0,l0,tjald_lane(2));
			tjald_aesenc_c(l0,l0,tjald_lane(6),tjald_lane(10));
			memcpy(out,l0,16);
			secret+=lanewidth;
			out+=lanewidth;
			
			memcpy(l0,secret,16);
			memcpy(secret,tjald_lane(10),16);
			tjald_aesenc_c(tjald_lane(9),tjald_lane(2),l0,tjald_lane(6));
			tjald_aesenc_c(tjald_lane(2),tjald_lane(6),l0,tjald_lane(10));
			tjald_aesenc_c(tjald_lane(6),tjald_lane(10),l0,tjald_lane(3));
			tjald_add_c(tjald_lane(8),tjald_lane(8),l0);
			tjald_and_c(l0,l0,tjald_lane(3));
			tjald_aesenc_c(l0,l0,tjald_lane(7),lanetmp);
			memcpy(out,l0,16);
			secret+=lanewidth;
			out+=lanewidth;
			
			memcpy(l0,secret,16);
			memcpy(secret,lanetmp,16);
			tjald_aesenc_c(tjald_lane(10),tjald_lane(3),l0,tjald_lane(7));
			tjald_aesenc_c(tjald_lane(3),tjald_lane(7),l0,lanetmp);
			tjald_aesenc_c(tjald_lane(7),lanetmp,l0,tjald_lane(0));
			tjald_add_c(tjald_lane(9),tjald_lane(9),l0);
			tjald_and_c(l0,l0,tjald_lane(0));
			tjald_aesenc_c(l0,l0,tjald_lane(4),tjald_lane(8));
			memcpy(out,l0,16);
			secret+=lanewidth;
			out+=lanewidth;
		}
	}
	
	void gesus_128_seed_c(gesus_128_state* state,const void* seed,size_t seed_length){
		const uint8_t* seedtype=(uint8_t*)seed;
		memset(state->secret,0,1024);
		memcpy(state->state,tjald_seed,176);
		#if defined(TJALD_BIG_ENDIAN)
			((uint64_t*)(state->state))[0]^=tjald_inverse_endianess_64((uint64_t)seed_length);
		#else
			((uint64_t*)(state->state))[0]^=seed_length;
		#endif
		state->spent=0;
		uint32_t copybuffer[64];
		size_t a;
		
		while(seed_length>256){
			memcpy(copybuffer,seedtype,256);
			for(a=0;a<64;a++){
				((uint32_t*)(state->secret))[a]^=copybuffer[a];
				((uint32_t*)(state->secret+272))[a]^=copybuffer[a];
				((uint32_t*)(state->secret+736))[a]^=copybuffer[a];
			}
			gesus_adaptive_advance_c(state->state,state->secret,state->output,16);
			seed_length-=256;
			seedtype+=256;
		}
		if(seed_length<256){
			copybuffer[seed_length>>2]=0;
		}
		memcpy(copybuffer,seedtype,seed_length);
		for(a=0;a<((seed_length+3)>>2);a++){
			((uint32_t*)(state->secret))[a]^=copybuffer[a];
			((uint32_t*)(state->secret+272))[a]^=copybuffer[a];
			((uint32_t*)(state->secret+736))[a]^=copybuffer[a];
		}
		gesus_adaptive_advance_c(state->state,state->secret,state->output,16);
	}
	
	void gesus_128_rand_c(gesus_128_state* state,void* output,size_t output_length){
		uint8_t* outtype=(uint8_t*)output;
		size_t left=(-state->spent)&1023;
		if(output_length>left){
			output_length-=left;
			state->spent+=left;
			memcpy(outtype,state->output+(1024-left),left);
			outtype+=left;
			left=0;
		}
		while(output_length>=1024){
			#if defined(TJALD_BIG_ENDIAN)
				((uint64_t*)(state->secret))[0]^=tjald_inverse_endianess_64(state->spent);
			#else
				((uint64_t*)(state->secret))[0]^=state->spent;
			#endif
			gesus_adaptive_advance_c(state->state,state->secret,outtype,16);
			outtype+=1024;
			output_length-=1024;
			state->spent+=1024;
		}
		if(output_length>left){
			#if defined(TJALD_BIG_ENDIAN)
				((uint64_t*)(state->secret))[0]^=tjald_inverse_endianess_64(state->spent);
			#else
				((uint64_t*)(state->secret))[0]^=state->spent;
			#endif
			gesus_adaptive_advance_c(state->state,state->secret,state->output,16);
			left=1024;
		}
		state->spent+=output_length;
		memcpy(outtype,state->output+(1024-left),output_length);
	}
	
	void gesus_512_seed_c(gesus_512_state* state,const void* seed,size_t seed_length){
		gesus_128_state state128;
		gesus_128_seed_c(&state128,seed,seed_length);
		gesus_128_rand_c(&state128,state->secret,1616);
		size_t a;
		memcpy(state->secret+1616,state->secret,1616);
		memcpy(state->secret+3232,state->secret,864);
		memcpy(state->state,state->secret+864,704);
		for(a=0;a<64;a+=16){
			gesus_adaptive_advance_c(state->state+a,state->secret+a,state->output+a,64);
		}
		state->spent=0;
	}
	
	void gesus_512_rand_c(gesus_512_state* state,void* output,size_t output_length){
		size_t a;
		uint8_t* outtype=(uint8_t*)output;
		size_t left=(-state->spent)&4095;
		if(output_length>left){
			output_length-=left;
			state->spent+=left;
			memcpy(outtype,state->output+(4096-left),left);
			outtype+=left;
			left=0;
		}
		while(output_length>=4096){
			for(a=0;a<64;a+=16){
				#if defined(TJALD_BIG_ENDIAN)
					((uint64_t*)(state->secret+a))[0]^=tjald_inverse_endianess_64(state->spent+(a>>4));
				#else
					((uint64_t*)(state->secret+a))[0]^=(state->spent+(a>>4));
				#endif
				gesus_adaptive_advance_c(state->state+a,state->secret+a,outtype+a,64);
			}
			outtype+=4096;
			output_length-=4096;
			state->spent+=4096;
		}
		if(output_length>left){
			for(a=0;a<64;a+=16){
				#if defined(TJALD_BIG_ENDIAN)
					((uint64_t*)(state->secret+a))[0]^=tjald_inverse_endianess_64(state->spent+(a>>4));
				#else
					((uint64_t*)(state->secret+a))[0]^=(state->spent+(a>>4));
				#endif
				gesus_adaptive_advance_c(state->state+a,state->secret+a,state->output+a,64);
			}
			left=4096;
		}
		state->spent+=output_length;
		memcpy(outtype,state->output+(4096-left),output_length);
	}
	
#endif

#if (defined(TJALD_ARM) || defined(TJALD_X86)) && !defined(TJALD_NO_AES)
	#define TJALD_AES_AVAILABLE
	TJALD_AES_ATTRIBUTE void tjald_memcpy_aes(void* dst,const void* src,size_t len){
		size_t a;
		tjald_128 s;
		const uint8_t* srct=(uint8_t*)src;
		uint8_t* dstt=(uint8_t*)dst;
		if(len>=16){
			len-=16;
			for(a=0;a<len;a+=16){
				tjald_load(s,srct+a);
				tjald_store(dstt+a,s);
			}
			tjald_load(s,srct+len);
			tjald_store(dstt+len,s);
		}
		else{
			for(a=0;a<len;a++){
				dstt[a]=srct[a];
			}
		}
	}
	
	TJALD_AES_ATTRIBUTE void tjald_memxor_aes(void* dst,const void* src,size_t len){
		size_t a;
		tjald_128 s,d,d2;
		const uint8_t* srct=(uint8_t*)src;
		uint8_t* dstt=(uint8_t*)dst;
		if(len>=16){
			len-=16;
			tjald_load(d2,dstt+len);
			for(a=0;a<len;a+=16){
				tjald_load(s,srct+a);
				tjald_load(d,dstt+a);
				tjald_xor(s,s,d);
				tjald_store(dstt+a,s);
			}
			tjald_load(s,srct+len);
			tjald_xor(s,s,d2);
			tjald_store(dstt+len,s);
		}
		else{
			for(a=0;a<len;a++){
				dstt[a]^=srct[a];
			}
		}
	}
	
	TJALD_AES_ATTRIBUTE void tjald_memzero_aes(void* dst,size_t len){
		size_t a;
		tjald_128 s;
		tjald_zero(s);
		uint8_t* dstt=(uint8_t*)dst;
		if(len>=16){
			len-=16;
			for(a=0;a<len;a+=16){
				tjald_store(dstt+a,s);
			}
			tjald_store(dstt+len,s);
		}
		else{
			for(a=0;a<len;a++){
				dstt[a]=0;
			}
		}
	}
	
	TJALD_AES_ATTRIBUTE void tjald_2_begin_aes(tjald_2_state* state,const uint8_t key[704]){
		if(key==(uint8_t*)0){
			key=tjald_seed;
		}
		uint8_t* statetype=(uint8_t*)state;
		tjald_memcpy_aes(statetype,key,704);
		tjald_memzero_aes(statetype+704,64);
	}

	TJALD_AES_ATTRIBUTE void tjald_3_begin_aes(tjald_3_state* state,const uint8_t key[704]){
		if(key==(uint8_t*)0){
			key=tjald_seed;
		}
		uint8_t* statetype=(uint8_t*)state;
		tjald_memcpy_aes(statetype,key,704);
		tjald_memzero_aes(statetype+704,320);
	}

	TJALD_AES_ATTRIBUTE void tjald_4_begin_aes(tjald_4_state* state){
		uint8_t* statetype=(uint8_t*)state;
		tjald_memcpy_aes(statetype,tjald_seed,704);
		tjald_memzero_aes(statetype+704,320);
	}

	TJALD_AES_ATTRIBUTE void tjald_adaptive_kernel(uint8_t* state,const uint8_t* input,size_t bunches,size_t lanewidth){
		uint64_t offset0_p;
		uint64_t offset1_p;
		uint64_t advancement_p;
		uint64_t rounds_p;
		if(bunches==5){
			offset0_p=0x019001001000000ULL*lanewidth;
			offset1_p=0x018000003002001ULL*lanewidth;
			advancement_p=0x002002004004002ULL*lanewidth;
			rounds_p=0x005003004004008ULL;
		}
		else if(bunches==3){
			offset0_p=0x011001000ULL*lanewidth;
			offset1_p=0x010000001ULL*lanewidth;
			advancement_p=0x002002002ULL*lanewidth;
			rounds_p=0x002002004ULL;
		}
		else{
			offset0_p=0;
			offset1_p=1*lanewidth;
			advancement_p=2*lanewidth;
			rounds_p=bunches>>1;
			bunches=1;
		}
		tjald_128 lane0,lane1,lane2,lane3,lane4,lane5,lane6,lane7,lane8,lane9,lane10,lanetmp;
		tjald_128 l0,l1;
		tjald_128 symmetrybreaker;
		tjald_load(symmetrybreaker,tjald_small_seed);
		tjald_load(lane0,state+0*lanewidth);
		tjald_load(lane1,state+1*lanewidth);
		tjald_load(lane2,state+2*lanewidth);
		tjald_load(lane3,state+3*lanewidth);
		tjald_load(lane4,state+4*lanewidth);
		tjald_load(lane5,state+5*lanewidth);
		tjald_load(lane6,state+6*lanewidth);
		tjald_load(lane7,state+7*lanewidth);
		tjald_load(lane8,state+8*lanewidth);
		tjald_load(lane9,state+9*lanewidth);
		tjald_load(lane10,state+10*lanewidth);
		size_t bunches_o=bunches;
		while(bunches>0){
			size_t offset0=offset0_p&4095;
			offset0_p>>=12;
			size_t offset1=offset1_p&4095;
			offset1_p>>=12;
			size_t advancement=advancement_p&4095;
			advancement_p>>=12;
			size_t rounds=rounds_p&4095;
			rounds_p>>=12;
			const uint8_t* input0=input+offset0;
			const uint8_t* input1=input+offset1;
			while(rounds>0){
				tjald_load(l0,input0);
				tjald_load(l1,input1);
				input0+=advancement;
				input1+=advancement;
				tjald_aesenc(lanetmp,lane0,l0,lane4);
				tjald_aesenc(lane0,lane4,l1,lane8);
				tjald_aesenc(lane4,lane8,l1,lane1);
				tjald_add(lane10,lane10,l0);
				tjald_load(l0,input0);
				tjald_load(l1,input1);
				input0+=advancement;
				input1+=advancement;
				tjald_aesenc(lane8,lane1,l0,lane5);
				tjald_aesenc(lane1,lane5,l1,lane9);
				tjald_aesenc(lane5,lane9,l1,lane2);
				tjald_add(lanetmp,lanetmp,l0);
				tjald_load(l0,input0);
				tjald_load(l1,input1);
				input0+=advancement;
				input1+=advancement;
				tjald_aesenc(lane9,lane2,l0,lane6);
				tjald_aesenc(lane2,lane6,l1,lane10);
				tjald_aesenc(lane6,lane10,l1,lane3);
				tjald_add(lane8,lane8,l0);
				tjald_load(l0,input0);
				tjald_load(l1,input1);
				input0+=advancement;
				input1+=advancement;
				tjald_aesenc(lane10,lane3,l0,lane7);
				tjald_aesenc(lane3,lane7,l1,lanetmp);
				tjald_aesenc(lane7,lanetmp,l1,lane0);
				tjald_add(lane9,lane9,l0);
				
				rounds--;
			}
			bunches--;
			if(bunches_o==3){
				switch(bunches){
					case 0:
						tjald_sub(lane2,lane2,symmetrybreaker);
						break;
					case 1:
						tjald_add(lane2,lane2,symmetrybreaker);
						break;
					case 2:
						tjald_add(lane6,lane6,symmetrybreaker);
						break;
				}
			}
			else if(bunches_o==5){
				switch(bunches){
					case 0:
						tjald_sub(lane2,lane2,symmetrybreaker);
						break;
					case 1:
						tjald_sub(lane2,lane2,symmetrybreaker);
						break;
					case 2:
						tjald_sub(lane6,lane6,symmetrybreaker);
						break;
					case 3:
						tjald_add(lane2,lane2,symmetrybreaker);
						break;
					case 4:
						tjald_add(lane6,lane6,symmetrybreaker);
						break;
				}
			}
		}
		if(bunches_o==5){
			tjald_load(lanetmp,state+0*lanewidth);
			tjald_xor(lane0,lane0,lanetmp);
			tjald_load(lanetmp,state+1*lanewidth);
			tjald_xor(lane1,lane1,lanetmp);
			tjald_load(lanetmp,state+2*lanewidth);
			tjald_xor(lane2,lane2,lanetmp);
			tjald_load(lanetmp,state+3*lanewidth);
			tjald_xor(lane3,lane3,lanetmp);
			tjald_load(lanetmp,state+4*lanewidth);
			tjald_xor(lane4,lane4,lanetmp);
			tjald_load(lanetmp,state+5*lanewidth);
			tjald_xor(lane5,lane5,lanetmp);
			tjald_load(lanetmp,state+6*lanewidth);
			tjald_xor(lane6,lane6,lanetmp);
			tjald_load(lanetmp,state+7*lanewidth);
			tjald_xor(lane7,lane7,lanetmp);
			tjald_load(lanetmp,state+8*lanewidth);
			tjald_xor(lane8,lane8,lanetmp);
			tjald_load(lanetmp,state+9*lanewidth);
			tjald_xor(lane9,lane9,lanetmp);
			tjald_load(lanetmp,state+10*lanewidth);
			tjald_xor(lane10,lane10,lanetmp);
		}
		tjald_store(state+0*lanewidth,lane0);
		tjald_store(state+1*lanewidth,lane1);
		tjald_store(state+2*lanewidth,lane2);
		tjald_store(state+3*lanewidth,lane3);
		tjald_store(state+4*lanewidth,lane4);
		tjald_store(state+5*lanewidth,lane5);
		tjald_store(state+6*lanewidth,lane6);
		tjald_store(state+7*lanewidth,lane7);
		tjald_store(state+8*lanewidth,lane8);
		tjald_store(state+9*lanewidth,lane9);
		tjald_store(state+10*lanewidth,lane10);
	}
	
	TJALD_AES_ATTRIBUTE void tjald_adaptive_final(uint8_t* state,size_t rounds,uint8_t out[64]){
		tjald_128 lane0,lane1,lane2,lane3,lane4,lane5,lane6,lane7,lane8,lane9,lane10,lanetmp;
		tjald_load(lane0,state+0*16);
		tjald_load(lane1,state+1*16);
		tjald_load(lane2,state+2*16);
		tjald_load(lane3,state+3*16);
		tjald_load(lane4,state+4*16);
		tjald_load(lane5,state+5*16);
		tjald_load(lane6,state+6*16);
		tjald_load(lane7,state+7*16);
		tjald_load(lane8,state+8*16);
		tjald_load(lane9,state+9*16);
		tjald_load(lane10,state+10*16);
		while(rounds>0){

			tjald_aesenc(lanetmp,lane0,lane8,lane4);
			tjald_aesenc(lane0,lane4,lane1,lane8);
			tjald_aesenc(lane4,lane8,lane10,lane2);
			tjald_add(lane9,lane9,lane10);

			tjald_aesenc(lane8,lane1,lane9,lane5);
			tjald_aesenc(lane1,lane5,lane2,lane9);
			tjald_aesenc(lane5,lane9,lanetmp,lane3);
			tjald_add(lane10,lane10,lanetmp);

			tjald_aesenc(lane9,lane2,lane10,lane6);
			tjald_aesenc(lane2,lane6,lane3,lane10);
			tjald_aesenc(lane6,lane10,lane8,lane0);
			tjald_add(lanetmp,lanetmp,lane8);

			tjald_aesenc(lane10,lane3,lanetmp,lane7);
			tjald_aesenc(lane3,lane7,lane0,lanetmp);
			tjald_aesenc(lane7,lanetmp,lane9,lane1);
			tjald_add(lane8,lane8,lane9);
			
			rounds--;
		}
		tjald_add(lane0,lane0,lane1);
		tjald_add(lane2,lane2,lane3);
		tjald_add(lane4,lane4,lane5);
		tjald_add(lane6,lane6,lane8);
		tjald_add(lane7,lane7,lane10);
		tjald_xor(lane0,lane0,lane6);
		tjald_xor(lane2,lane2,lane9);
		tjald_store(out,lane0);
		tjald_store(out+16,lane2);
		tjald_store(out+32,lane4);
		tjald_store(out+48,lane7);
	}

	TJALD_AES_ATTRIBUTE void tjald_2_absorb_aes(tjald_2_state* state,const void* input,size_t input_length){
		const uint8_t* input8=(uint8_t*)input;
		size_t a;
		size_t length=*(uint32_t*)(state->state+764);
		size_t bufferlength=length&511;
		length=(length+input_length)|((((input_length>=4096)<<31)|length)&0x80000000U);
		*(uint32_t*)(state->state+764)=(uint32_t)length;
		if(bufferlength>0){
			size_t tocopy=512-bufferlength;
			if(input_length<tocopy){
				tjald_memcpy_aes(state->buffer+bufferlength,input8,input_length);
				return;
			}
			else{
				tjald_memcpy_aes(state->buffer+bufferlength,input8,tocopy);
				for(a=0;a<64;a+=16){
					tjald_adaptive_kernel(state->state+a,state->buffer+a,2,64);
				}
				input8+=tocopy;
				input_length-=tocopy;
			}
		}
		size_t block32=input_length>>14;
		while(block32>0){
			for(a=0;a<64;a+=16){
				tjald_adaptive_kernel(state->state+a,input8+a,64,64);
			}
			input8+=1<<14;
			block32--;
		}
		input_length&=(1<<14)-1;
		size_t fullblocks=input_length>>9;
		if(fullblocks>0){
			for(a=0;a<64;a+=16){
				tjald_adaptive_kernel(state->state+a,input8+a,fullblocks*2,64);
			}
			input8+=fullblocks<<9;
			input_length&=511;
		}
		tjald_memcpy_aes(state->buffer,input8,input_length);
	}
	
	TJALD_AES_ATTRIBUTE void tjald_3_absorb_aes(tjald_3_state* state,const void* input,size_t input_length){
		const uint8_t* input8=(uint8_t*)input;
		size_t a;
		size_t length=*(uint32_t*)(state->state+1020);
		size_t bufferlength=length&2047;
		length=(length+input_length)|((((input_length>=4096)<<31)|length)&0x80000000U);
		*(uint32_t*)(state->state+1020)=(uint32_t)length;
		if(bufferlength>0){
			size_t tocopy=2048-bufferlength;
			if(input_length<tocopy){
				tjald_memcpy_aes(state->buffer+bufferlength,input8,input_length);
				return;
			}
			else{
				tjald_memcpy_aes(state->buffer+bufferlength,input8,tocopy);
				for(a=0;a<64;a+=16){
					tjald_adaptive_kernel(state->state+a,state->buffer+a,3,64);
				}
				input8+=tocopy;
				input_length-=tocopy;
			}
		}
		while(input_length>=(1<<11)){
			for(a=0;a<64;a+=16){
				tjald_adaptive_kernel(state->state+a,input8+a,3,64);
			}
			input8+=1<<11;
			input_length-=1<<11;
		}
		tjald_memcpy_aes(state->buffer,input8,input_length);
	}
	
	TJALD_AES_ATTRIBUTE void tjald_4_absorb_aes(tjald_4_state* state,const void* input,size_t input_length){
		const uint8_t* input8=(uint8_t*)input;
		size_t a;
		size_t length=*(uint32_t*)(state->state+1020);
		size_t bufferlength=length&4095;
		length=(length+input_length)|((((input_length>=4096)<<31)|length)&0x80000000U);
		*(uint32_t*)(state->state+1020)=(uint32_t)length;
		if(bufferlength>0){
			size_t tocopy=4096-bufferlength;
			if(input_length<tocopy){
				tjald_memcpy_aes(state->buffer+bufferlength,input8,input_length);
				return;
			}
			else{
				tjald_memcpy_aes(state->buffer+bufferlength,input8,tocopy);
				for(a=0;a<64;a+=16){
					tjald_adaptive_kernel(state->state+a,state->buffer+a,5,64);
				}
				input8+=tocopy;
				input_length-=tocopy;
			}
		}
		while(input_length>=(1<<12)){
			for(a=0;a<64;a+=16){
				tjald_adaptive_kernel(state->state+a,input8+a,5,64);
			}
			input8+=1<<12;
			input_length-=1<<12;
		}
		tjald_memcpy_aes(state->buffer,input8,input_length);
	}
	
	TJALD_AES_ATTRIBUTE void tjald_2_end_aes(tjald_2_state* state,uint8_t out[64]){
		size_t a;
		uint32_t length=*(uint32_t*)(state->state+764);
		size_t bufferlength=length&511;
		
		uint8_t* newlanes;
		uint8_t* newbuffer;
		size_t newbuffercount;
		if(length<=508){
			newbuffercount=(length+4+127)>>7;
			uint8_t* zerospot=state->buffer+bufferlength;
			size_t zerolength=(newbuffercount<<7)-bufferlength-4;
			tjald_memzero_aes(zerospot,zerolength);
			((uint32_t*)(zerospot+zerolength))[0]=length;
			newlanes=state->state;
			newbuffer=state->buffer;
		}
		else{
			*(uint32_t*)(state->state+764)=length|0x80000000U;
			if(bufferlength>0){
				uint8_t* zerospot=state->buffer+bufferlength;
				size_t zerolength=512-bufferlength;
				tjald_memzero_aes(zerospot,zerolength);
				for(a=0;a<64;a+=16){
					tjald_adaptive_kernel(state->state+a,state->buffer+a,2,64);
				}
			}
			tjald_memcpy_aes(state->buffer,tjald_seed,176);
			newlanes=state->buffer;
			newbuffer=state->state;
			newbuffercount=6;
		}
		tjald_adaptive_kernel(newlanes,newbuffer,2*newbuffercount,16);
		tjald_adaptive_final(newlanes,4,out);
	}
	
	TJALD_AES_ATTRIBUTE void tjald_3_end_aes(tjald_3_state* state,uint8_t out[64]){
		size_t a;
		uint32_t length=*(uint32_t*)(state->state+1020);
		size_t bufferlength=length&2047;
		
		uint8_t* newlanes;
		uint8_t* newbuffer;
		size_t newbuffercount;
		if(length<=2044){
			newbuffercount=(length+4+511)>>9;
			uint8_t* zerospot=state->buffer+bufferlength;
			size_t zerolength=(newbuffercount<<9)-bufferlength-4;
			tjald_memzero_aes(zerospot,zerolength);
			((uint32_t*)(zerospot+zerolength))[0]=length;
			newlanes=state->state;
			newbuffer=state->buffer;
		}
		else{
			*(uint32_t*)(state->state+1020)=length|0x80000000U;
			if(bufferlength>0){
				uint8_t* zerospot=state->buffer+bufferlength;
				size_t zerolength=2048-bufferlength;
				tjald_memzero_aes(zerospot,zerolength);
				for(a=0;a<64;a+=16){
					tjald_adaptive_kernel(state->state+a,state->buffer+a,3,64);
				}
			}
			tjald_memcpy_aes(state->buffer,tjald_seed,176);
			newlanes=state->buffer;
			newbuffer=state->state;
			newbuffercount=2;
		}
		while(newbuffercount>0){
			tjald_adaptive_kernel(newlanes,newbuffer,3,16);
			newbuffer+=512;
			newbuffercount--;
		}
		tjald_adaptive_final(newlanes,6,out);
	}
	
	TJALD_AES_ATTRIBUTE void tjald_4_end_aes(tjald_4_state* state,uint8_t out[64]){
		size_t a;
		uint32_t length=*(uint32_t*)(state->state+1020);
		size_t bufferlength=length&4095;
		
		uint8_t* newlanes;
		uint8_t* newbuffer;
		size_t newbuffercount;
		if(length<=4092){
			newbuffercount=(length+4+1023)>>10;
			uint8_t* zerospot=state->buffer+bufferlength;
			size_t zerolength=(newbuffercount<<10)-bufferlength-4;
			tjald_memzero_aes(zerospot,zerolength);
			((uint32_t*)(zerospot+zerolength))[0]=length;
			newlanes=state->state;
			newbuffer=state->buffer;
		}
		else{
			*(uint32_t*)(state->state+1020)=length|0x80000000U;
			if(bufferlength>0){
				uint8_t* zerospot=state->buffer+bufferlength;
				size_t zerolength=4096-bufferlength;
				tjald_memzero_aes(zerospot,zerolength);
				for(a=0;a<64;a+=16){
					tjald_adaptive_kernel(state->state+a,state->buffer+a,5,64);
				}
			}
			tjald_memcpy_aes(state->buffer,tjald_seed,176);
			newlanes=state->buffer;
			newbuffer=state->state;
			newbuffercount=1;
		}
		while(newbuffercount>0){
			tjald_adaptive_kernel(newlanes,newbuffer,5,16);
			newbuffer+=1024;
			newbuffercount--;
		}
		tjald_adaptive_final(newlanes,8,out);
	}
	
	TJALD_AES_ATTRIBUTE void tjald_2_aes(const uint8_t key[704],const void* input,size_t input_length,uint8_t out[64]){
		tjald_2_state state;
		tjald_2_begin_aes(&state,key);
		tjald_2_absorb_aes(&state,input,input_length);
		tjald_2_end_aes(&state,out);
	}

	TJALD_AES_ATTRIBUTE void tjald_3_aes(const uint8_t key[704],const void* input,size_t input_length,uint8_t out[64]){
		tjald_3_state state;
		tjald_3_begin_aes(&state,key);
		tjald_3_absorb_aes(&state,input,input_length);
		tjald_3_end_aes(&state,out);
	}

	TJALD_AES_ATTRIBUTE void tjald_4_aes(const void* input,size_t input_length,uint8_t out[64]){
		tjald_4_state state;
		tjald_4_begin_aes(&state);
		tjald_4_absorb_aes(&state,input,input_length);
		tjald_4_end_aes(&state,out);
	}
	
	TJALD_AES_ATTRIBUTE void gesus_adaptive_advance(uint8_t* state,uint8_t* secret,uint8_t* out,size_t lanewidth){
		tjald_128 lane0,lane1,lane2,lane3,lane4,lane5,lane6,lane7,lane8,lane9,lane10,lanetmp;
		tjald_load(lane0,state+0*lanewidth);
		tjald_load(lane1,state+1*lanewidth);
		tjald_load(lane2,state+2*lanewidth);
		tjald_load(lane3,state+3*lanewidth);
		tjald_load(lane4,state+4*lanewidth);
		tjald_load(lane5,state+5*lanewidth);
		tjald_load(lane6,state+6*lanewidth);
		tjald_load(lane7,state+7*lanewidth);
		tjald_load(lane8,state+8*lanewidth);
		tjald_load(lane9,state+9*lanewidth);
		tjald_load(lane10,state+10*lanewidth);
		size_t a;
		tjald_128 l0;
		for(a=0;a<16;a++){
			tjald_load(l0,secret);
			tjald_store(secret,lane8);
			tjald_aesenc(lanetmp,lane0,l0,lane4);
			tjald_aesenc(lane0,lane4,l0,lane8);
			tjald_aesenc(lane4,lane8,l0,lane1);
			tjald_add(lane10,lane10,l0);
			tjald_and(l0,l0,lane1);
			tjald_aesenc(l0,l0,lane5,lane9);
			tjald_store(out,l0);
			secret+=lanewidth;
			out+=lanewidth;
			
			tjald_load(l0,secret);
			tjald_store(secret,lane9);
			tjald_aesenc(lane8,lane1,l0,lane5);
			tjald_aesenc(lane1,lane5,l0,lane9);
			tjald_aesenc(lane5,lane9,l0,lane2);
			tjald_add(lanetmp,lanetmp,l0);
			tjald_and(l0,l0,lane2);
			tjald_aesenc(l0,l0,lane6,lane10);
			tjald_store(out,l0);
			secret+=lanewidth;
			out+=lanewidth;
			
			tjald_load(l0,secret);
			tjald_store(secret,lane10);
			tjald_aesenc(lane9,lane2,l0,lane6);
			tjald_aesenc(lane2,lane6,l0,lane10);
			tjald_aesenc(lane6,lane10,l0,lane3);
			tjald_add(lane8,lane8,l0);
			tjald_and(l0,l0,lane3);
			tjald_aesenc(l0,l0,lane7,lanetmp);
			tjald_store(out,l0);
			secret+=lanewidth;
			out+=lanewidth;
			
			tjald_load(l0,secret);
			tjald_store(secret,lanetmp);
			tjald_aesenc(lane10,lane3,l0,lane7);
			tjald_aesenc(lane3,lane7,l0,lanetmp);
			tjald_aesenc(lane7,lanetmp,l0,lane0);
			tjald_add(lane9,lane9,l0);
			tjald_and(l0,l0,lane0);
			tjald_aesenc(l0,l0,lane4,lane8);
			tjald_store(out,l0);
			secret+=lanewidth;
			out+=lanewidth;
		}
		tjald_store(state+0*lanewidth,lane0);
		tjald_store(state+1*lanewidth,lane1);
		tjald_store(state+2*lanewidth,lane2);
		tjald_store(state+3*lanewidth,lane3);
		tjald_store(state+4*lanewidth,lane4);
		tjald_store(state+5*lanewidth,lane5);
		tjald_store(state+6*lanewidth,lane6);
		tjald_store(state+7*lanewidth,lane7);
		tjald_store(state+8*lanewidth,lane8);
		tjald_store(state+9*lanewidth,lane9);
		tjald_store(state+10*lanewidth,lane10);
	}
	
	TJALD_AES_ATTRIBUTE void gesus_128_seed_aes(gesus_128_state* state,const void* seed,size_t seed_length){
		const uint8_t* seedtype=(uint8_t*)seed;
		tjald_memzero_aes(state->secret,1024);
		tjald_memcpy_aes(state->state,tjald_seed,176);
		((uint64_t*)(state->state))[0]^=seed_length;
		state->spent=0;
		
		while(seed_length>256){
			tjald_memxor_aes(state->secret,seedtype,256);
			tjald_memxor_aes(state->secret+272,seedtype,256);
			tjald_memxor_aes(state->secret+736,seedtype,256);
			gesus_adaptive_advance(state->state,state->secret,state->output,16);
			seed_length-=256;
			seedtype+=256;
		}
		tjald_memxor_aes(state->secret,seedtype,seed_length);
		tjald_memxor_aes(state->secret+272,seedtype,seed_length);
		tjald_memxor_aes(state->secret+736,seedtype,seed_length);
		gesus_adaptive_advance(state->state,state->secret,state->output,16);
	}
	
	TJALD_AES_ATTRIBUTE void gesus_128_rand_aes(gesus_128_state* state,void* output,size_t output_length){
		uint8_t* outtype=(uint8_t*)output;
		size_t left=(-state->spent)&1023;
		if(output_length>left){
			output_length-=left;
			state->spent+=left;
			tjald_memcpy_aes(outtype,state->output+(1024-left),left);
			outtype+=left;
			left=0;
		}
		while(output_length>=1024){
			((uint64_t*)(state->secret))[0]^=state->spent;
			gesus_adaptive_advance(state->state,state->secret,outtype,16);
			outtype+=1024;
			output_length-=1024;
			state->spent+=1024;
		}
		if(output_length>left){
			((uint64_t*)(state->secret))[0]^=state->spent;
			gesus_adaptive_advance(state->state,state->secret,state->output,16);
			left=1024;
		}
		state->spent+=output_length;
		tjald_memcpy_aes(outtype,state->output+(1024-left),output_length);
	}
	
	TJALD_AES_ATTRIBUTE void gesus_512_seed_aes(gesus_512_state* state,const void* seed,size_t seed_length){
		gesus_128_state state128;
		gesus_128_seed_aes(&state128,seed,seed_length);
		gesus_128_rand_aes(&state128,state->secret,1616);
		size_t a;
		tjald_memcpy_aes(state->secret+1616,state->secret,1616);
		tjald_memcpy_aes(state->secret+3232,state->secret,864);
		tjald_memcpy_aes(state->state,state->secret+864,704);
		for(a=0;a<64;a+=16){
			gesus_adaptive_advance(state->state+a,state->secret+a,state->output+a,64);
		}
		state->spent=0;
	}
	
	TJALD_AES_ATTRIBUTE void gesus_512_rand_aes(gesus_512_state* state,void* output,size_t output_length){
		size_t a;
		uint8_t* outtype=(uint8_t*)output;
		size_t left=(-state->spent)&4095;
		if(output_length>left){
			output_length-=left;
			state->spent+=left;
			tjald_memcpy_aes(outtype,state->output+(4096-left),left);
			outtype+=left;
			left=0;
		}
		while(output_length>=4096){
			for(a=0;a<64;a+=16){
				((uint64_t*)(state->secret+a))[0]^=(state->spent+(a>>4));
				gesus_adaptive_advance(state->state+a,state->secret+a,outtype+a,64);
			}
			outtype+=4096;
			output_length-=4096;
			state->spent+=4096;
		}
		if(output_length>left){
			for(a=0;a<64;a+=16){
				((uint64_t*)(state->secret+a))[0]^=(state->spent+(a>>4));
				gesus_adaptive_advance(state->state+a,state->secret+a,state->output+a,64);
			}
			left=4096;
		}
		state->spent+=output_length;
		tjald_memcpy_aes(outtype,state->output+(4096-left),output_length);
	}

#endif

void tjald_expand_seed(const void* seed,size_t seed_length,uint8_t expanded_key[704]){
	gesus_128_state state;
	gesus_128_seed(&state,seed,seed_length);
	gesus_128_rand(&state,expanded_key,704);
}

int tjald_once_limit(int limit){
	int level=0;
	#if defined(TJALD_ASM_AVAILABLE)
		level=tjald_once_asm_limit(limit);
		if(level>=3){
			return level;
		}
	#elif defined(TJALD_AES_AVAILABLE)
		#if defined(TJALD_X86)
			uint32_t cpuidarray[4];
			#if defined(TJALD_MSVC)
				__cpuidex(cpuidarray,1,0);
			#else
				__cpuid_count(1,0,cpuidarray[0],cpuidarray[1],cpuidarray[2],cpuidarray[3]);
			#endif
			if((cpuidarray[2] & 0x2000000)!=0){
				level=2;
			}
		#elif defined(TJALD_ARM)
			#if defined(TJALD_ARM_LINUX)
				#if defined(TJALD_ARM_64)
					long hwcaps=getauxval(AT_HWCAP);
					if(hwcaps & HWCAP_AES){
						level=2;
					}
				#else
					long hwcaps2=getauxval(AT_HWCAP2);
					if(hwcaps2 & HWCAP2_AES){
						level=2;
					}
				#endif
			#else
				level=2; //YOLO, there is apparently no fixed way of knowing if the CPU supports hardware AES. Biggest group that would break because of this is probably old iOS devices.
			#endif
		#endif
		if(limit<level){
			level=limit;
		}
	#endif

	#if defined(TJALD_AES_AVAILABLE)
		if(level>=2){
			tjald_fn_pointers.tjald_2_begin_i=&tjald_2_begin_aes;
			tjald_fn_pointers.tjald_2_absorb_i=&tjald_2_absorb_aes;
			tjald_fn_pointers.tjald_2_end_i=&tjald_2_end_aes;
			tjald_fn_pointers.tjald_2_i=&tjald_2_aes;
			tjald_fn_pointers.tjald_3_begin_i=&tjald_3_begin_aes;
			tjald_fn_pointers.tjald_3_absorb_i=&tjald_3_absorb_aes;
			tjald_fn_pointers.tjald_3_end_i=&tjald_3_end_aes;
			tjald_fn_pointers.tjald_3_i=&tjald_3_aes;
			tjald_fn_pointers.tjald_4_begin_i=&tjald_4_begin_aes;
			tjald_fn_pointers.tjald_4_absorb_i=&tjald_4_absorb_aes;
			tjald_fn_pointers.tjald_4_end_i=&tjald_4_end_aes;
			tjald_fn_pointers.tjald_4_i=&tjald_4_aes;
			
			tjald_fn_pointers.gesus_128_seed_i=&gesus_128_seed_aes;
			tjald_fn_pointers.gesus_128_rand_i=&gesus_128_rand_aes;
			tjald_fn_pointers.gesus_512_seed_i=&gesus_512_seed_aes;
			tjald_fn_pointers.gesus_512_rand_i=&gesus_512_rand_aes;
			return 2;
		}
	#endif
	#if defined(TJALD_C_AVAILABLE)	
		tjald_fn_pointers.tjald_2_begin_i=&tjald_2_begin_c;
		tjald_fn_pointers.tjald_2_absorb_i=&tjald_2_absorb_c;
		tjald_fn_pointers.tjald_2_end_i=&tjald_2_end_c;
		tjald_fn_pointers.tjald_2_i=&tjald_2_c;
		tjald_fn_pointers.tjald_3_begin_i=&tjald_3_begin_c;
		tjald_fn_pointers.tjald_3_absorb_i=&tjald_3_absorb_c;
		tjald_fn_pointers.tjald_3_end_i=&tjald_3_end_c;
		tjald_fn_pointers.tjald_3_i=&tjald_3_c;
		tjald_fn_pointers.tjald_4_begin_i=&tjald_4_begin_c;
		tjald_fn_pointers.tjald_4_absorb_i=&tjald_4_absorb_c;
		tjald_fn_pointers.tjald_4_end_i=&tjald_4_end_c;
		tjald_fn_pointers.tjald_4_i=&tjald_4_c;
		
		tjald_fn_pointers.gesus_128_seed_i=&gesus_128_seed_c;
		tjald_fn_pointers.gesus_128_rand_i=&gesus_128_rand_c;
		tjald_fn_pointers.gesus_512_seed_i=&gesus_512_seed_c;
		tjald_fn_pointers.gesus_512_rand_i=&gesus_512_rand_c;
		return 0;
	#else
		return -1;
	#endif
}

int tjald_once(){
	return tjald_once_limit(6);
}

//#include <stdio.h>

int tjald_self_test(){
	uint8_t testbuffer[10000];
	gesus_128_state r1;
	gesus_512_state r2;
	gesus_128_seed(&r1,testbuffer,0);
	gesus_128_rand(&r1,testbuffer,10000);
	gesus_128_rand(&r1,testbuffer+79,5731);
	gesus_128_rand(&r1,testbuffer+6234,2048);
	gesus_128_rand(&r1,testbuffer+9344,345);
	gesus_512_seed(&r2,testbuffer+3,9977);
	gesus_512_rand(&r2,testbuffer,67);
	gesus_512_rand(&r2,testbuffer+5072,783);
	gesus_512_rand(&r2,testbuffer+640,3945);
	gesus_512_rand(&r2,testbuffer+6662,2201);
	tjald_2(testbuffer+457,testbuffer+45,233,testbuffer+9000);
	tjald_3(testbuffer+457,testbuffer+45,233,testbuffer+9100);
	tjald_4(testbuffer+45,233,testbuffer+9200);
	tjald_2((uint8_t*)0,testbuffer+451,6734,testbuffer+9300);
	tjald_3((uint8_t*)0,testbuffer+451,6734,testbuffer+9400);
	tjald_4(testbuffer+451,6734,testbuffer+9500);
	tjald_4(testbuffer+1000,9000,testbuffer);
	uint8_t expected[32]={231,60,42,202,25,138,243,226,170,0,150,46,21,201,92,50,246,180,78,227,128,128,21,204,44,132,231,204,215,176,16,198};
	size_t a;
	/*
	for(a=0;a<32;a++){
		printf("%u,",testbuffer[a]);
	}
	*/
	for(a=0;a<32;a++){
		if(expected[a]!=testbuffer[a]){
			return 0;
		}
	}
	return TJALD_NICE;
}

